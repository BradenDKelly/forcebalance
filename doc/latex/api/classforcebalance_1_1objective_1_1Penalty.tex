\hypertarget{classforcebalance_1_1objective_1_1Penalty}{\subsection{forcebalance.\-objective.\-Penalty Class Reference}
\label{classforcebalance_1_1objective_1_1Penalty}\index{forcebalance.\-objective.\-Penalty@{forcebalance.\-objective.\-Penalty}}
}


\hyperlink{classforcebalance_1_1objective_1_1Penalty}{Penalty} functions for regularizing the force field optimizer.  


\subsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classforcebalance_1_1objective_1_1Penalty_aa2df9566dd3b054b48ddac60eae56f1f}{\-\_\-\-\_\-init\-\_\-\-\_\-}
\item 
def \hyperlink{classforcebalance_1_1objective_1_1Penalty_a844137de5dfb3e7907c37769d1306495}{compute}
\item 
def \hyperlink{classforcebalance_1_1objective_1_1Penalty_ab59d5beafbab0918b7c3e0c61ece41a3}{L2\-\_\-norm}
\begin{DoxyCompactList}\small\item\em Harmonic L2-\/norm constraints. \end{DoxyCompactList}\item 
def \hyperlink{classforcebalance_1_1objective_1_1Penalty_a1f3fa55d1c27db3eca0af41bb57c04ef}{H\-Y\-P}
\begin{DoxyCompactList}\small\item\em Hyperbolic constraints. \end{DoxyCompactList}\item 
def \hyperlink{classforcebalance_1_1objective_1_1Penalty_aafc1810e03e4e3f2ca1569588a8189d4}{F\-U\-S\-E}
\item 
def \hyperlink{classforcebalance_1_1objective_1_1Penalty_a9badc0a78d23016aa3dcc2d610e2e16c}{F\-U\-S\-E\-\_\-\-B\-A\-R\-R\-I\-E\-R}
\item 
def \hyperlink{classforcebalance_1_1objective_1_1Penalty_ab54cfe22065a5aa22766e16cc8cb90aa}{F\-U\-S\-E\-\_\-\-L0}
\end{DoxyCompactItemize}
\subsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classforcebalance_1_1objective_1_1Penalty_a8c93cd0cfa455a54f957a061b5f7ac50}{fadd}
\item 
\hyperlink{classforcebalance_1_1objective_1_1Penalty_a71912752947b920f8679f09ed3a098a7}{fmul}
\item 
\hyperlink{classforcebalance_1_1objective_1_1Penalty_abab984da8a8f62adbd1decbaf56ac2fa}{a}
\item 
\hyperlink{classforcebalance_1_1objective_1_1Penalty_a0d9da5669d74dfd54a2fc639424e37b6}{b}
\item 
\hyperlink{classforcebalance_1_1objective_1_1Penalty_a4f8b9595066e7b51fa219bbfd98608ae}{F\-F}
\item 
\hyperlink{classforcebalance_1_1objective_1_1Penalty_aafed9613564329fc6a760aec26a43116}{ptyp}
\item 
\hyperlink{classforcebalance_1_1objective_1_1Penalty_a22bcc263d510e34d694faa9a70372a03}{Pen\-\_\-\-Tab}
\item 
\hyperlink{classforcebalance_1_1objective_1_1Penalty_a9832c430eccb9edf404ba12ed2f54541}{spacings}
\begin{DoxyCompactList}\small\item\em Find exponential spacings. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
dictionary \hyperlink{classforcebalance_1_1objective_1_1Penalty_a0565dc1b08520f13edc984c14aa7ceb8}{Pen\-\_\-\-Names}
\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
\hyperlink{classforcebalance_1_1objective_1_1Penalty}{Penalty} functions for regularizing the force field optimizer. 

The purpose for this module is to improve the behavior of our optimizer; essentially, our problem is fraught with 'linear dependencies', a.\-k.\-a. directions in the parameter space that the objective function does not respond to. This would happen if a parameter is just plain useless, or if there are two or more parameters that describe the same thing.

To accomplish these objectives, a penalty function is added to the objective function. Generally, the more the parameters change (i.\-e. the greater the norm of the parameter vector), the greater the penalty. Note that this is added on after all of the other contributions have been computed. This only matters if the penalty 'multiplies' the objective function\-: Obj + Obj$\ast$\-Penalty, but we also have the option of an additive penalty\-: Obj + \hyperlink{classforcebalance_1_1objective_1_1Penalty}{Penalty}.

Statistically, this is called regularization. If the penalty function is the norm squared of the parameter vector, it is called ridge regression. There is also the option of using simply the norm, and this is called lasso, but I think it presents problems for the optimizer that I need to work out.

Note that the penalty functions can be considered as part of a 'maximum likelihood' framework in which we assume a P\-R\-I\-O\-R P\-R\-O\-B\-A\-B\-I\-L\-I\-T\-Y of the force field parameters around their initial values. The penalty function is related to the prior by an exponential. Ridge regression corresponds to a Gaussian prior and lasso corresponds to an exponential prior. There is also 'elastic net regression' which interpolates between Gaussian and exponential using a tuning parameter.

Our priors are adjustable too -\/ there is one parameter, which is the width of the distribution. We can even use a noninformative prior for the distribution widths (hyperprior!). These are all important things to consider later.

Importantly, note that here there is no code that treats the distribution width. That is because the distribution width is wrapped up in the rescaling factors, which is essentially a coordinate transformation on the parameter space. More documentation on this will follow, perhaps in the 'rsmake' method. 

Definition at line 308 of file objective.\-py.



\subsubsection{Constructor \& Destructor Documentation}
\hypertarget{classforcebalance_1_1objective_1_1Penalty_aa2df9566dd3b054b48ddac60eae56f1f}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!\-\_\-\-\_\-init\-\_\-\-\_\-@{\-\_\-\-\_\-init\-\_\-\-\_\-}}
\index{\-\_\-\-\_\-init\-\_\-\-\_\-@{\-\_\-\-\_\-init\-\_\-\-\_\-}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{\-\_\-\-\_\-init\-\_\-\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}def forcebalance.\-objective.\-Penalty.\-\_\-\-\_\-init\-\_\-\-\_\- (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{User\-\_\-\-Option, }
\item[{}]{Force\-Field, }
\item[{}]{Factor\-\_\-\-Add = {\ttfamily 0.0}, }
\item[{}]{Factor\-\_\-\-Mult = {\ttfamily 0.0}, }
\item[{}]{Factor\-\_\-\-B = {\ttfamily 0.1}, }
\item[{}]{Alpha = {\ttfamily 1.0}}
\end{DoxyParamCaption}
)}}\label{classforcebalance_1_1objective_1_1Penalty_aa2df9566dd3b054b48ddac60eae56f1f}


Definition at line 314 of file objective.\-py.



\subsubsection{Member Function Documentation}
\hypertarget{classforcebalance_1_1objective_1_1Penalty_a844137de5dfb3e7907c37769d1306495}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!compute@{compute}}
\index{compute@{compute}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{compute}]{\setlength{\rightskip}{0pt plus 5cm}def forcebalance.\-objective.\-Penalty.\-compute (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{mvals, }
\item[{}]{Objective}
\end{DoxyParamCaption}
)}}\label{classforcebalance_1_1objective_1_1Penalty_a844137de5dfb3e7907c37769d1306495}


Definition at line 340 of file objective.\-py.



Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classforcebalance_1_1objective_1_1Penalty_a844137de5dfb3e7907c37769d1306495_cgraph}
\end{center}
\end{figure}


\hypertarget{classforcebalance_1_1objective_1_1Penalty_aafc1810e03e4e3f2ca1569588a8189d4}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!F\-U\-S\-E@{F\-U\-S\-E}}
\index{F\-U\-S\-E@{F\-U\-S\-E}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{F\-U\-S\-E}]{\setlength{\rightskip}{0pt plus 5cm}def forcebalance.\-objective.\-Penalty.\-F\-U\-S\-E (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{mvals}
\end{DoxyParamCaption}
)}}\label{classforcebalance_1_1objective_1_1Penalty_aafc1810e03e4e3f2ca1569588a8189d4}


Definition at line 400 of file objective.\-py.



Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classforcebalance_1_1objective_1_1Penalty_aafc1810e03e4e3f2ca1569588a8189d4_cgraph}
\end{center}
\end{figure}


\hypertarget{classforcebalance_1_1objective_1_1Penalty_a9badc0a78d23016aa3dcc2d610e2e16c}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!F\-U\-S\-E\-\_\-\-B\-A\-R\-R\-I\-E\-R@{F\-U\-S\-E\-\_\-\-B\-A\-R\-R\-I\-E\-R}}
\index{F\-U\-S\-E\-\_\-\-B\-A\-R\-R\-I\-E\-R@{F\-U\-S\-E\-\_\-\-B\-A\-R\-R\-I\-E\-R}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{F\-U\-S\-E\-\_\-\-B\-A\-R\-R\-I\-E\-R}]{\setlength{\rightskip}{0pt plus 5cm}def forcebalance.\-objective.\-Penalty.\-F\-U\-S\-E\-\_\-\-B\-A\-R\-R\-I\-E\-R (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{mvals}
\end{DoxyParamCaption}
)}}\label{classforcebalance_1_1objective_1_1Penalty_a9badc0a78d23016aa3dcc2d610e2e16c}


Definition at line 441 of file objective.\-py.



Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classforcebalance_1_1objective_1_1Penalty_a9badc0a78d23016aa3dcc2d610e2e16c_cgraph}
\end{center}
\end{figure}


\hypertarget{classforcebalance_1_1objective_1_1Penalty_ab54cfe22065a5aa22766e16cc8cb90aa}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!F\-U\-S\-E\-\_\-\-L0@{F\-U\-S\-E\-\_\-\-L0}}
\index{F\-U\-S\-E\-\_\-\-L0@{F\-U\-S\-E\-\_\-\-L0}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{F\-U\-S\-E\-\_\-\-L0}]{\setlength{\rightskip}{0pt plus 5cm}def forcebalance.\-objective.\-Penalty.\-F\-U\-S\-E\-\_\-\-L0 (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{mvals}
\end{DoxyParamCaption}
)}}\label{classforcebalance_1_1objective_1_1Penalty_ab54cfe22065a5aa22766e16cc8cb90aa}


Definition at line 483 of file objective.\-py.



Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classforcebalance_1_1objective_1_1Penalty_ab54cfe22065a5aa22766e16cc8cb90aa_cgraph}
\end{center}
\end{figure}


\hypertarget{classforcebalance_1_1objective_1_1Penalty_a1f3fa55d1c27db3eca0af41bb57c04ef}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!H\-Y\-P@{H\-Y\-P}}
\index{H\-Y\-P@{H\-Y\-P}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{H\-Y\-P}]{\setlength{\rightskip}{0pt plus 5cm}def forcebalance.\-objective.\-Penalty.\-H\-Y\-P (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{mvals}
\end{DoxyParamCaption}
)}}\label{classforcebalance_1_1objective_1_1Penalty_a1f3fa55d1c27db3eca0af41bb57c04ef}


Hyperbolic constraints. 

Depending on the 'b' parameter, the smaller it is, the closer we are to an L1-\/norm constraint. If we use these, we expect a properly-\/behaving optimizer to make several of the parameters very nearly zero (which would be cool).


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mvals} & The parameter vector \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
D\-C0 The hyperbolic penalty 

D\-C1 The gradient 

D\-C2 The Hessian 
\end{DoxyReturn}


Definition at line 392 of file objective.\-py.



Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classforcebalance_1_1objective_1_1Penalty_a1f3fa55d1c27db3eca0af41bb57c04ef_cgraph}
\end{center}
\end{figure}


\hypertarget{classforcebalance_1_1objective_1_1Penalty_ab59d5beafbab0918b7c3e0c61ece41a3}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!L2\-\_\-norm@{L2\-\_\-norm}}
\index{L2\-\_\-norm@{L2\-\_\-norm}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{L2\-\_\-norm}]{\setlength{\rightskip}{0pt plus 5cm}def forcebalance.\-objective.\-Penalty.\-L2\-\_\-norm (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{mvals}
\end{DoxyParamCaption}
)}}\label{classforcebalance_1_1objective_1_1Penalty_ab59d5beafbab0918b7c3e0c61ece41a3}


Harmonic L2-\/norm constraints. 

These are the ones that I use the most often to regularize my optimization.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mvals} & The parameter vector \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
D\-C0 The norm squared of the vector 

D\-C1 The gradient of D\-C0 

D\-C2 The Hessian (just a constant) 
\end{DoxyReturn}


Definition at line 372 of file objective.\-py.



Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classforcebalance_1_1objective_1_1Penalty_ab59d5beafbab0918b7c3e0c61ece41a3_cgraph}
\end{center}
\end{figure}




\subsubsection{Member Data Documentation}
\hypertarget{classforcebalance_1_1objective_1_1Penalty_abab984da8a8f62adbd1decbaf56ac2fa}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!a@{a}}
\index{a@{a}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{a}]{\setlength{\rightskip}{0pt plus 5cm}forcebalance.\-objective.\-Penalty.\-a}}\label{classforcebalance_1_1objective_1_1Penalty_abab984da8a8f62adbd1decbaf56ac2fa}


Definition at line 317 of file objective.\-py.

\hypertarget{classforcebalance_1_1objective_1_1Penalty_a0d9da5669d74dfd54a2fc639424e37b6}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!b@{b}}
\index{b@{b}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{b}]{\setlength{\rightskip}{0pt plus 5cm}forcebalance.\-objective.\-Penalty.\-b}}\label{classforcebalance_1_1objective_1_1Penalty_a0d9da5669d74dfd54a2fc639424e37b6}


Definition at line 318 of file objective.\-py.

\hypertarget{classforcebalance_1_1objective_1_1Penalty_a8c93cd0cfa455a54f957a061b5f7ac50}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!fadd@{fadd}}
\index{fadd@{fadd}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{fadd}]{\setlength{\rightskip}{0pt plus 5cm}forcebalance.\-objective.\-Penalty.\-fadd}}\label{classforcebalance_1_1objective_1_1Penalty_a8c93cd0cfa455a54f957a061b5f7ac50}


Definition at line 315 of file objective.\-py.

\hypertarget{classforcebalance_1_1objective_1_1Penalty_a4f8b9595066e7b51fa219bbfd98608ae}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!F\-F@{F\-F}}
\index{F\-F@{F\-F}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{F\-F}]{\setlength{\rightskip}{0pt plus 5cm}forcebalance.\-objective.\-Penalty.\-F\-F}}\label{classforcebalance_1_1objective_1_1Penalty_a4f8b9595066e7b51fa219bbfd98608ae}


Definition at line 319 of file objective.\-py.

\hypertarget{classforcebalance_1_1objective_1_1Penalty_a71912752947b920f8679f09ed3a098a7}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!fmul@{fmul}}
\index{fmul@{fmul}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{fmul}]{\setlength{\rightskip}{0pt plus 5cm}forcebalance.\-objective.\-Penalty.\-fmul}}\label{classforcebalance_1_1objective_1_1Penalty_a71912752947b920f8679f09ed3a098a7}


Definition at line 316 of file objective.\-py.

\hypertarget{classforcebalance_1_1objective_1_1Penalty_a0565dc1b08520f13edc984c14aa7ceb8}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!Pen\-\_\-\-Names@{Pen\-\_\-\-Names}}
\index{Pen\-\_\-\-Names@{Pen\-\_\-\-Names}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{Pen\-\_\-\-Names}]{\setlength{\rightskip}{0pt plus 5cm}dictionary forcebalance.\-objective.\-Penalty.\-Pen\-\_\-\-Names\hspace{0.3cm}{\ttfamily [static]}}}\label{classforcebalance_1_1objective_1_1Penalty_a0565dc1b08520f13edc984c14aa7ceb8}
{\bfseries Initial value\-:}
\begin{DoxyCode}
1 = \{\textcolor{stringliteral}{'HYP'} : 1, \textcolor{stringliteral}{'HYPER'} : 1, \textcolor{stringliteral}{'HYPERBOLIC'} : 1, \textcolor{stringliteral}{'L1'} : 1, \textcolor{stringliteral}{'HYPERBOLA'} : 1,
2                       \textcolor{stringliteral}{'PARA'} : 2, \textcolor{stringliteral}{'PARABOLA'} : 2, \textcolor{stringliteral}{'PARABOLIC'} : 2, \textcolor{stringliteral}{'L2'}: 2, \textcolor{stringliteral}{'QUADRATIC'} : 2,
3                       \textcolor{stringliteral}{'FUSE'} : 3, \textcolor{stringliteral}{'FUSION'} : 3, \textcolor{stringliteral}{'FUSE\_L0'} : 4, \textcolor{stringliteral}{'FUSION\_L0'} : 4, \textcolor{stringliteral}{'FUSION-L0'} : 4,
4                       \textcolor{stringliteral}{'FUSE-BARRIER'} : 5, \textcolor{stringliteral}{'FUSE-BARRIER'} : 5, \textcolor{stringliteral}{'FUSE\_BARRIER'} : 5, \textcolor{stringliteral}{'FUSION\_BARRIER'} : 5\}
\end{DoxyCode}


Definition at line 309 of file objective.\-py.

\hypertarget{classforcebalance_1_1objective_1_1Penalty_a22bcc263d510e34d694faa9a70372a03}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!Pen\-\_\-\-Tab@{Pen\-\_\-\-Tab}}
\index{Pen\-\_\-\-Tab@{Pen\-\_\-\-Tab}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{Pen\-\_\-\-Tab}]{\setlength{\rightskip}{0pt plus 5cm}forcebalance.\-objective.\-Penalty.\-Pen\-\_\-\-Tab}}\label{classforcebalance_1_1objective_1_1Penalty_a22bcc263d510e34d694faa9a70372a03}


Definition at line 321 of file objective.\-py.

\hypertarget{classforcebalance_1_1objective_1_1Penalty_aafed9613564329fc6a760aec26a43116}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!ptyp@{ptyp}}
\index{ptyp@{ptyp}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{ptyp}]{\setlength{\rightskip}{0pt plus 5cm}forcebalance.\-objective.\-Penalty.\-ptyp}}\label{classforcebalance_1_1objective_1_1Penalty_aafed9613564329fc6a760aec26a43116}


Definition at line 320 of file objective.\-py.

\hypertarget{classforcebalance_1_1objective_1_1Penalty_a9832c430eccb9edf404ba12ed2f54541}{\index{forcebalance\-::objective\-::\-Penalty@{forcebalance\-::objective\-::\-Penalty}!spacings@{spacings}}
\index{spacings@{spacings}!forcebalance::objective::Penalty@{forcebalance\-::objective\-::\-Penalty}}
\paragraph[{spacings}]{\setlength{\rightskip}{0pt plus 5cm}forcebalance.\-objective.\-Penalty.\-spacings}}\label{classforcebalance_1_1objective_1_1Penalty_a9832c430eccb9edf404ba12ed2f54541}


Find exponential spacings. 



Definition at line 337 of file objective.\-py.



The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
\hyperlink{objective_8py}{objective.\-py}\end{DoxyCompactItemize}
