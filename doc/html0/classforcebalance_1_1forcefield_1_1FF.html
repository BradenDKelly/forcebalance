<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ForceBalance: forcebalance.forcefield.FF Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="ForceBalanceLogo_sm.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ForceBalance
   &#160;<span id="projectnumber">0.11.0</span>
   </div>
   <div id="projectbrief">Automated optimization of force fields and empirical potentials</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/namespaces.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>forcebalance</b>      </li>
      <li class="navelem"><b>forcefield</b>      </li>
      <li class="navelem"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html">FF</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a>  </div>
  <div class="headertitle">
<div class="title">forcebalance.forcefield.FF Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="forcebalance::forcefield::FF" -->
<p>Force field class.  
 <a href="classforcebalance_1_1forcefield_1_1FF.html#details">More...</a></p>

<p><a href="classforcebalance_1_1forcefield_1_1FF-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#aef2e183571128eea70132c7be2a8dc5d">__init__</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Instantiation of force field class.  <a href="#aef2e183571128eea70132c7be2a8dc5d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a142d41c86b9b0ef57f93ec6fb349357b">addff</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a force field file and add it to the class.  <a href="#a142d41c86b9b0ef57f93ec6fb349357b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#aecd595ddb369aedd7009e6756276ffc5">make</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new force field using provided parameter values.  <a href="#aecd595ddb369aedd7009e6756276ffc5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a260031479e0429e497f56987de541930">create_pvals</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts mathematical to physical parameters.  <a href="#a260031479e0429e497f56987de541930"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#ae5fba4d3e22f210632ead3653e6e12dd">create_mvals</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts physical to mathematical parameters.  <a href="#ae5fba4d3e22f210632ead3653e6e12dd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a3965b1b353e0e72d3001906aee31a7ef">replace_pvals</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Replaces numerical fields in stored force field files with the stored physical parameter values.  <a href="#a3965b1b353e0e72d3001906aee31a7ef"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#adf766c97d811fe9501557b66c33eb084">print_newstuff</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints out the new content of force fields to files in 'printdir'.  <a href="#adf766c97d811fe9501557b66c33eb084"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a88715f96ff8e14c3c83b4f976ad147b4">rsmake</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the rescaling factors for the coordinate transformation in parameter space.  <a href="#a88715f96ff8e14c3c83b4f976ad147b4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#acf0ce8fc4e9fbf5257f93d14d4a4f10f">mktransmat</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the transformation matrix to rescale and rotate the mathematical parameters.  <a href="#acf0ce8fc4e9fbf5257f93d14d4a4f10f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#ac0046446695a65cb2489fdb560ef5929">list_map</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the plist, which is like a reversed version of the parameter map.  <a href="#ac0046446695a65cb2489fdb560ef5929"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a61082e99cb3a02e35c80bbea919eaafa">print_map</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints out the (physical or mathematical) parameter indices, IDs and values in a visually appealing way.  <a href="#a61082e99cb3a02e35c80bbea919eaafa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a3af07734a2378364ed533e2853ee6b82">assign_p0</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign physical parameter values to the 'pvals0' array.  <a href="#a3af07734a2378364ed533e2853ee6b82"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a2c9cda9adb5a6446fbccfa7b35f8dff5">assign_field</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Record the locations of a parameter in a file; [[file name, line number, field number, and multiplier]].  <a href="#a2c9cda9adb5a6446fbccfa7b35f8dff5"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3212d7a016d1e1e65249cb0147ebecbb"></a><!-- doxytag: member="forcebalance::forcefield::FF::root" ref="a3212d7a016d1e1e65249cb0147ebecbb" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a3212d7a016d1e1e65249cb0147ebecbb">root</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The root directory of the project. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1534c7fcccf4d877d0288e371dcc318c"></a><!-- doxytag: member="forcebalance::forcefield::FF::fnms" ref="a1534c7fcccf4d877d0288e371dcc318c" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a1534c7fcccf4d877d0288e371dcc318c">fnms</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">File names of force fields. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa2172f23b0d01ea15ff14a6795734f62"></a><!-- doxytag: member="forcebalance::forcefield::FF::ffdir" ref="aa2172f23b0d01ea15ff14a6795734f62" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#aa2172f23b0d01ea15ff14a6795734f62">ffdir</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Directory containing force fields, relative to project directory. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ace535d538a683e676371739fe2ec6092"></a><!-- doxytag: member="forcebalance::forcefield::FF::stuff" ref="ace535d538a683e676371739fe2ec6092" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#ace535d538a683e676371739fe2ec6092">stuff</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The content of all force field files are stored in memory. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0b4c59bcf7ecb19000b3a173151a7c5b"></a><!-- doxytag: member="forcebalance::forcefield::FF::map" ref="a0b4c59bcf7ecb19000b3a173151a7c5b" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a0b4c59bcf7ecb19000b3a173151a7c5b">map</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The mapping of interaction type -&gt; parameter number. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2d12bd53577f14af5e8d4b64ebb6281f"></a><!-- doxytag: member="forcebalance::forcefield::FF::plist" ref="a2d12bd53577f14af5e8d4b64ebb6281f" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a2d12bd53577f14af5e8d4b64ebb6281f">plist</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The listing of parameter number -&gt; interaction types. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#aa521223f43f9629b30384491cafbd10c">pfields</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A list where pfields[pnum] = ['file',line,field,mult], basically a new way to modify force field files; when we modify the force field file, we go to the specific line/field in a given file and change the number.  <a href="#aa521223f43f9629b30384491cafbd10c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a3424d0271d9eebf1962ad87286ec9fc3">rs</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">List of rescaling factors.  <a href="#a3424d0271d9eebf1962ad87286ec9fc3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3ecc51355dbd97e0b1620007924fd2a3"></a><!-- doxytag: member="forcebalance::forcefield::FF::tm" ref="a3ecc51355dbd97e0b1620007924fd2a3" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a3ecc51355dbd97e0b1620007924fd2a3">tm</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The transformation matrix for mathematical -&gt; physical parameters. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9c49407242f4e8da1c42530825c6dbda"></a><!-- doxytag: member="forcebalance::forcefield::FF::tmI" ref="a9c49407242f4e8da1c42530825c6dbda" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a9c49407242f4e8da1c42530825c6dbda">tmI</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The transpose of the transformation matrix. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#aa630b2a2142d81e30c5751ed13a7b777">excision</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Indices to exclude from optimization / Hessian inversion.  <a href="#aa630b2a2142d81e30c5751ed13a7b777"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5f04fa76bff707688a394542f893993d"></a><!-- doxytag: member="forcebalance::forcefield::FF::np" ref="a5f04fa76bff707688a394542f893993d" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a5f04fa76bff707688a394542f893993d">np</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The total number of parameters. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a681cf6c42115d8b250a2294c726fead0">newstuff</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The force field content, but with parameter fields replaced with new parameters.  <a href="#a681cf6c42115d8b250a2294c726fead0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4d6fbc589839d65aaf4dc417b05afba3"></a><!-- doxytag: member="forcebalance::forcefield::FF::pvals0" ref="a4d6fbc589839d65aaf4dc417b05afba3" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a4d6fbc589839d65aaf4dc417b05afba3">pvals0</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial value of physical parameters. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a849ac9d6e43c32f7cacba27af3af70e8"></a><!-- doxytag: member="forcebalance::forcefield::FF::R" ref="a849ac9d6e43c32f7cacba27af3af70e8" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><b>R</b></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Force field class. </p>
<p>This class contains all methods for force field manipulation. To create an instance of this class, an input file is required containing the list of force field file names. Everything else inside this class pertaining to force field generation is self-contained.</p>
<p>For details on force field parsing, see the detailed documentation for addff. </p>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00159">159</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aef2e183571128eea70132c7be2a8dc5d"></a><!-- doxytag: member="forcebalance::forcefield::FF::__init__" ref="aef2e183571128eea70132c7be2a8dc5d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#aef2e183571128eea70132c7be2a8dc5d">forcebalance.forcefield.FF.__init__</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Instantiation of force field class. </p>
<p>Many variables here are initialized to zero, but they are filled out by methods like addff, rsmake, and mktransmat. </p>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00167">167</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a142d41c86b9b0ef57f93ec6fb349357b"></a><!-- doxytag: member="forcebalance::forcefield::FF::addff" ref="a142d41c86b9b0ef57f93ec6fb349357b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a142d41c86b9b0ef57f93ec6fb349357b">forcebalance.forcefield.FF.addff</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ffname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Parse a force field file and add it to the class. </p>
<p>First, we need to figure out the type of file file. Currently this is done using the three-letter file extension ('.itp' = gmx); that can be improved.</p>
<p>First we open the force field file and read all of its lines. As we loop through the force field file, we look for two types of tags: (1) section markers, in GMX indicated by [ section_name ], which allows us to determine the section, and (2) parameter tags, indicated by the 'PARM' or 'RPT' keywords.</p>
<p>As we go through the file, we figure out the atoms involved in the interaction described on each line.</p>
<p>When a 'PARM' keyword is indicated, it is followed by a number which is the field in the line to be modified, starting with zero. Based on the field number and the section name, we can figure out the parameter type. With the parameter type and the atoms in hand, we construct a 'parameter identifier' or pid which uniquely identifies that parameter. We also store the physical parameter value in an array called 'pvals0' and the precise location of that parameter (by filename, line number, and field number) in a list called 'pfields'.</p>
<p>An example: Suppose in 'my_ff.itp' I encounter the following on lines 146 and 147:</p>
<div class="fragment"><pre class="fragment">         [ angletypes ]
         CA   CB   O   1   109.47  350.00  ; PARM 4 5
</pre></div><p>From reading <code>[ angletypes ]</code> I know I'm in the 'angletypes' section.</p>
<p>On the next line, I notice two parameters on fields 4 and 5.</p>
<p>From the atom types, section type and field number I know the parameter IDs are <code>'ANGLESBCACBO'</code> and <code>'ANGLESKCACBO'</code>.</p>
<p>After building <code>map={'ANGLESBCACBO':1,'ANGLESKCACBO':2}</code>, I store the values in an array: <code>pvals0=array([109.47,350.00])</code>, and I put the parameter locations in pfields: <code>pfields=[['my_ff.itp',147,4,1.0],['my_ff.itp',146,5,1.0]]</code>. The 1.0 is a 'multiplier' and I will explain it below.</p>
<p>Note that in the creation of parameter IDs, we run into the issue that the atoms involved in the interaction may be labeled in reverse order (e.g. <code>OCACB</code>). Thus, we store both the normal and the reversed parameter ID in the map.</p>
<p>Parameter repetition and multiplier:</p>
<p>If <code>'RPT'</code> is encountered in the line, it is always in the syntax: <code>'RPT 4 ANGLESBCACAH 5 MINUS_ANGLESKCACAH /RPT'</code>. In this case, field 4 is replaced by the stored parameter value corresponding to <code>ANGLESBCACAH</code> and field 5 is replaced by -1 times the stored value of <code>ANGLESKCACAH</code>. Now I just picked this as an example, I don't think people actually want a negative angle force constant .. :) the <code>MINUS</code> keyword does come in handy for assigning atomic charges and virtual site positions. In order to achieve this, a multiplier of -1.0 is stored into pfields instead of 1.0.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000010">Todo:</a></b></dt><dd>Note that I can also create the opposite virtual site position by changing the atom labeling, woo!</dd></dl>
<dl class="warning"><dt><b>Warning:</b></dt><dd>My program currently assumes that we are only using one MM program per job. If we use CHARMM and GROMACS to perform fitting simulations in the same job, we will get f-ed up. Maybe this needs to be fixed in the future, with program prefixes to parameters like C_ , G_ .. or simply unit conversions, you get the idea.</dd>
<dd>
I don't think the multiplier actually works for analytic derivatives unless the interaction calculator knows the multiplier as well. I'm sure I can make this work in the future if necessary.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ffname</td><td>Name of the force field file </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00301">301</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classforcebalance_1_1forcefield_1_1FF_a142d41c86b9b0ef57f93ec6fb349357b_cgraph.svg" width="539" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2c9cda9adb5a6446fbccfa7b35f8dff5"></a><!-- doxytag: member="forcebalance::forcefield::FF::assign_field" ref="a2c9cda9adb5a6446fbccfa7b35f8dff5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a2c9cda9adb5a6446fbccfa7b35f8dff5">forcebalance.forcefield.FF.assign_field</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fnm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pfld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Record the locations of a parameter in a file; [[file name, line number, field number, and multiplier]]. </p>
<p>Note that parameters can have multiple locations because of the repetition functionality.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>The index of the parameter. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fnm</td><td>The file name of the parameter field. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ln</td><td>The line number within the file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pfld</td><td>The field within the line. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mult</td><td>The multiplier (this is usually 1.0) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00609">609</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<a class="anchor" id="a3af07734a2378364ed533e2853ee6b82"></a><!-- doxytag: member="forcebalance::forcefield::FF::assign_p0" ref="a3af07734a2378364ed533e2853ee6b82" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a3af07734a2378364ed533e2853ee6b82">forcebalance.forcefield.FF.assign_p0</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Assign physical parameter values to the 'pvals0' array. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>The index to which we assign the parameter value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>The parameter value to be inserted. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00591">591</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<a class="anchor" id="ae5fba4d3e22f210632ead3653e6e12dd"></a><!-- doxytag: member="forcebalance::forcefield::FF::create_mvals" ref="ae5fba4d3e22f210632ead3653e6e12dd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#ae5fba4d3e22f210632ead3653e6e12dd">forcebalance.forcefield.FF.create_mvals</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pvals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Converts physical to mathematical parameters. </p>
<p>We create the inverse transformation matrix using SVD.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pvals</td><td>The physical parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>mvals The mathematical parameters </dd></dl>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00394">394</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<a class="anchor" id="a260031479e0429e497f56987de541930"></a><!-- doxytag: member="forcebalance::forcefield::FF::create_pvals" ref="a260031479e0429e497f56987de541930" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a260031479e0429e497f56987de541930">forcebalance.forcefield.FF.create_pvals</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mvals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Converts mathematical to physical parameters. </p>
<p>First, mathematical parameters are rescaled and rotated by multiplying by the transformation matrix, followed by adding the original physical parameters.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mvals</td><td>The mathematical parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>pvals The physical parameters </dd></dl>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00382">382</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<a class="anchor" id="ac0046446695a65cb2489fdb560ef5929"></a><!-- doxytag: member="forcebalance::forcefield::FF::list_map" ref="ac0046446695a65cb2489fdb560ef5929" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#ac0046446695a65cb2489fdb560ef5929">forcebalance.forcefield.FF.list_map</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create the plist, which is like a reversed version of the parameter map. </p>
<p>More convenient for printing. </p>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00571">571</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<a class="anchor" id="aecd595ddb369aedd7009e6756276ffc5"></a><!-- doxytag: member="forcebalance::forcefield::FF::make" ref="aecd595ddb369aedd7009e6756276ffc5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#aecd595ddb369aedd7009e6756276ffc5">forcebalance.forcefield.FF.make</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>printdir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>usepvals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a new force field using provided parameter values. </p>
<p>This big kahuna does a number of things: 1) Creates the physical parameters from the mathematical parameters 2) Creates force fields with physical parameters substituted in 3) Prints the force fields to the specified file.</p>
<p>It does NOT store the mathematical parameters in the class state (since we can only hold one set of parameters).</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">printdir</td><td>The directory that the force fields are printed to; as usual this is relative to the project root directory. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vals</td><td>Input parameters. I previously had an option where it uses stored values in the class state, but I don't think that's a good idea anymore. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">usepvals</td><td>Switch for whether to bypass the coordinate transformation and use physical parameters directly. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00362">362</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classforcebalance_1_1forcefield_1_1FF_aecd595ddb369aedd7009e6756276ffc5_cgraph.svg" width="558" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="acf0ce8fc4e9fbf5257f93d14d4a4f10f"></a><!-- doxytag: member="forcebalance::forcefield::FF::mktransmat" ref="acf0ce8fc4e9fbf5257f93d14d4a4f10f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#acf0ce8fc4e9fbf5257f93d14d4a4f10f">forcebalance.forcefield.FF.mktransmat</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create the transformation matrix to rescale and rotate the mathematical parameters. </p>
<p>For point charge parameters, project out perturbations that change the total charge.</p>
<p>First build these:</p>
<p>'qmap' : Just a list of parameter indices that point to charges.</p>
<p>'qid' : For each parameter in the qmap, a list of the affected atoms :) A potential target for the molecule-specific thang.</p>
<p>Then make this:</p>
<p>'qtrans2' : A transformation matrix that rotates the charge parameters. The first row is all zeros (because it corresponds to increasing the charge on all atoms) The other rows correspond to changing one of the parameters and decreasing all of the others equally such that the overall charge is preserved.</p>
<p>'qmat2' : An identity matrix with 'qtrans2' pasted into the right place</p>
<p>'transmat': 'qmat2' with rows and columns scaled using self.rs</p>
<p>'excision': Parameter indices that need to be 'cut out' because they are irrelevant and mess with the matrix diagonalization</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000012">Todo:</a></b></dt><dd>Only project out changes in total charge of a molecule, and perhaps generalize to fragments of molecules or other types of parameters. </dd></dl>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00502">502</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<a class="anchor" id="a61082e99cb3a02e35c80bbea919eaafa"></a><!-- doxytag: member="forcebalance::forcefield::FF::print_map" ref="a61082e99cb3a02e35c80bbea919eaafa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a61082e99cb3a02e35c80bbea919eaafa">forcebalance.forcefield.FF.print_map</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vals</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prints out the (physical or mathematical) parameter indices, IDs and values in a visually appealing way. </p>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00580">580</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<a class="anchor" id="adf766c97d811fe9501557b66c33eb084"></a><!-- doxytag: member="forcebalance::forcefield::FF::print_newstuff" ref="adf766c97d811fe9501557b66c33eb084" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#adf766c97d811fe9501557b66c33eb084">forcebalance.forcefield.FF.print_newstuff</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>printdir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prints out the new content of force fields to files in 'printdir'. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">printdir</td><td>The directory to which new force fields are printed. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00425">425</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<a class="anchor" id="a3965b1b353e0e72d3001906aee31a7ef"></a><!-- doxytag: member="forcebalance::forcefield::FF::replace_pvals" ref="a3965b1b353e0e72d3001906aee31a7ef" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a3965b1b353e0e72d3001906aee31a7ef">forcebalance.forcefield.FF.replace_pvals</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pvals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Replaces numerical fields in stored force field files with the stored physical parameter values. </p>
<p>Unless you really know what you're doing, you probably shouldn't be calling this directly. </p>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00404">404</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<a class="anchor" id="a88715f96ff8e14c3c83b4f976ad147b4"></a><!-- doxytag: member="forcebalance::forcefield::FF::rsmake" ref="a88715f96ff8e14c3c83b4f976ad147b4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a88715f96ff8e14c3c83b4f976ad147b4">forcebalance.forcefield.FF.rsmake</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>printfacs</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create the rescaling factors for the coordinate transformation in parameter space. </p>
<p>The proper choice of rescaling factors (read: prior widths in maximum likelihood analysis) is still a black art. This is a topic of current research.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Pass in rsfactors through the input file</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">printfacs</td><td>List for printing out the resecaling factors </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00442">442</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aa630b2a2142d81e30c5751ed13a7b777"></a><!-- doxytag: member="forcebalance::forcefield::FF::excision" ref="aa630b2a2142d81e30c5751ed13a7b777" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#aa630b2a2142d81e30c5751ed13a7b777">forcebalance::forcefield.FF::excision</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Indices to exclude from optimization / Hessian inversion. </p>
<p>chargegrp = [[1,3],[4,5],[6,7]] for group in chargegrp: a = min(group[0]-1, group[1]) b = max(group[0]-1, group[1]) constemp = zeros(tq, dtype=float) for i in range(constemp.shape[0]): if i &gt;= a and i &lt; b: constemp[i] += 1 else: constemp[i] -= 1 cons0 = vstack((cons0, constemp)) print cons0 Here is where we build the qtrans2 matrix.</p>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00181">181</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<a class="anchor" id="a681cf6c42115d8b250a2294c726fead0"></a><!-- doxytag: member="forcebalance::forcefield::FF::newstuff" ref="a681cf6c42115d8b250a2294c726fead0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a681cf6c42115d8b250a2294c726fead0">forcebalance::forcefield.FF::newstuff</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The force field content, but with parameter fields replaced with new parameters. </p>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00183">183</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<a class="anchor" id="aa521223f43f9629b30384491cafbd10c"></a><!-- doxytag: member="forcebalance::forcefield::FF::pfields" ref="aa521223f43f9629b30384491cafbd10c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#aa521223f43f9629b30384491cafbd10c">forcebalance::forcefield.FF::pfields</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A list where pfields[pnum] = ['file',line,field,mult], basically a new way to modify force field files; when we modify the force field file, we go to the specific line/field in a given file and change the number. </p>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00177">177</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<a class="anchor" id="a3424d0271d9eebf1962ad87286ec9fc3"></a><!-- doxytag: member="forcebalance::forcefield::FF::rs" ref="a3424d0271d9eebf1962ad87286ec9fc3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classforcebalance_1_1forcefield_1_1FF.html#a3424d0271d9eebf1962ad87286ec9fc3">forcebalance::forcefield.FF::rs</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>List of rescaling factors. </p>
<p>Takes the dictionary 'BONDS':{3:'B', 4:'K'}, 'VDW':{4:'S', 5:'T'}, and turns it into a list of term types ['BONDSB','BONDSK','VDWS','VDWT'].</p>
<p>The array of rescaling factors </p>

<p>Definition at line <a class="el" href="forcefield_8py_source.html#l00178">178</a> of file <a class="el" href="forcefield_8py_source.html">forcefield.py</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>forcebalance/forcebalance/<a class="el" href="forcefield_8py_source.html">forcefield.py</a></li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Thu Feb 2 2012 13:21:20 for ForceBalance by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
