<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ForceBalance: forcebalance/forcebalance/molecule.py Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="ForceBalanceLogo_sm.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ForceBalance
   &#160;<span id="projectnumber">0.11.0</span>
   </div>
   <div id="projectbrief">Automated optimization of force fields and empirical potentials</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/namespaces.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">forcebalance/forcebalance/molecule.py</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">##</span>
<a name="l00002"></a>00002 <span class="comment"># @package molecule</span>
<a name="l00003"></a>00003 <span class="comment"># </span>
<a name="l00004"></a>00004 <span class="comment"># Lee-Ping&#39;s convenience library for parsing molecule file formats.</span>
<a name="l00005"></a>00005 <span class="comment"># Motivation: I&#39;m not quite sure what OpenBabel does, don&#39;t fully trust it</span>
<a name="l00006"></a>00006 <span class="comment"># I need to be very careful with Q-Chem input files and use input templates</span>
<a name="l00007"></a>00007 <span class="comment"># I&#39;d like to replace the grordr module because it&#39;s so old.</span>
<a name="l00008"></a>00008 <span class="comment"># </span>
<a name="l00009"></a>00009 <span class="comment"># Currently i can read xyz, gro, com, and arc</span>
<a name="l00010"></a>00010 <span class="comment"># Currently i can write xyz, gro, qcin (with Q-Chem template file)</span>
<a name="l00011"></a>00011 <span class="comment"># </span>
<a name="l00012"></a>00012 <span class="comment"># Not sure what&#39;s next on the chopping block, but please stay consistent when adding new methods.</span>
<a name="l00013"></a>00013 <span class="comment"># </span>
<a name="l00014"></a>00014 <span class="comment"># @author Lee-Ping Wang</span>
<a name="l00015"></a>00015 <span class="comment"># @date 12/2011</span>
<a name="l00016"></a>00016 <span class="comment"># </span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="keyword">from</span> re <span class="keyword">import</span> match, sub, split
<a name="l00019"></a>00019 <span class="keyword">from</span> sys <span class="keyword">import</span> argv, exit, stdout
<a name="l00020"></a>00020 <span class="keyword">from</span> PT <span class="keyword">import</span> PT
<a name="l00021"></a>00021 <span class="keyword">from</span> nifty <span class="keyword">import</span> isint, isfloat
<a name="l00022"></a>00022 <span class="keyword">from</span> numpy <span class="keyword">import</span> array
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="comment">##</span>
<a name="l00025"></a>00025 <span class="comment">#  Print a line consisting of (element, x, y, z) in accordance with .xyz file format</span>
<a name="l00026"></a>00026 <span class="comment"># </span>
<a name="l00027"></a>00027 <span class="comment">#     @param[in] element A chemical element of a single atom</span>
<a name="l00028"></a>00028 <span class="comment">#     @param[in] xyz A 3-element array containing x, y, z coordinates of that atom</span>
<a name="l00029"></a>00029 <span class="comment"># </span>
<a name="l00030"></a>00030 <span class="comment">#     </span>
<a name="l00031"></a>00031 <span class="keyword">def </span>format_xyz_coord(element,xyz,tinker=False):
<a name="l00032"></a>00032     <span class="keywordflow">if</span> tinker:
<a name="l00033"></a>00033         <span class="keywordflow">return</span> <span class="stringliteral">&quot;%-3s% 12.6f% 12.6f% 12.6f&quot;</span> % (element,xyz[0],xyz[1],xyz[2])
<a name="l00034"></a>00034     <span class="keywordflow">else</span>:
<a name="l00035"></a>00035         <span class="keywordflow">return</span> <span class="stringliteral">&quot;%-5s% 16.10f% 16.10f% 16.10f&quot;</span> % (element,xyz[0],xyz[1],xyz[2])
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="comment">##</span>
<a name="l00038"></a>00038 <span class="comment">#  Print a line in accordance with .gro file format</span>
<a name="l00039"></a>00039 <span class="comment"># </span>
<a name="l00040"></a>00040 <span class="comment">#     @param[in] resid The number of the residue that the atom belongs to</span>
<a name="l00041"></a>00041 <span class="comment">#     @param[in] resname The name of the residue that the atom belongs to</span>
<a name="l00042"></a>00042 <span class="comment">#     @param[in] aname The name of the atom</span>
<a name="l00043"></a>00043 <span class="comment">#     @param[in] seqno The sequential number of the atom</span>
<a name="l00044"></a>00044 <span class="comment">#     @param[in] xyz A 3-element array containing x, y, z coordinates of that atom</span>
<a name="l00045"></a>00045 <span class="comment">#     </span>
<a name="l00046"></a>00046 <span class="comment">#     </span>
<a name="l00047"></a>00047 <span class="keyword">def </span>format_gro_coord(resid, resname, aname, seqno, xyz):
<a name="l00048"></a>00048     <span class="keywordflow">return</span> <span class="stringliteral">&quot;%5i%-5s%5s%5i% 11.6f% 11.6f% 11.6f&quot;</span> % (resid,resname,aname,seqno,xyz[0],xyz[1],xyz[2])
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="comment">##</span>
<a name="l00051"></a>00051 <span class="comment">#  Print a line corresponding to the box vector in accordance with .gro file format</span>
<a name="l00052"></a>00052 <span class="comment"># </span>
<a name="l00053"></a>00053 <span class="comment">#     @param[in] xyz A 3-element or 9-element array containing the box vectors</span>
<a name="l00054"></a>00054 <span class="comment">#     </span>
<a name="l00055"></a>00055 <span class="comment">#     </span>
<a name="l00056"></a>00056 <span class="keyword">def </span>format_gro_box(xyz):
<a name="l00057"></a>00057     <span class="keywordflow">return</span> <span class="stringliteral">&#39; &#39;</span>.join([<span class="stringliteral">&quot;%11.6f&quot;</span> % (i/10) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xyz])
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="comment">##</span>
<a name="l00060"></a>00060 <span class="comment">#  Determines whether a line contains GROMACS data or not</span>
<a name="l00061"></a>00061 <span class="comment"># </span>
<a name="l00062"></a>00062 <span class="comment">#     @param[in] line The line to be tested</span>
<a name="l00063"></a>00063 <span class="comment">#     </span>
<a name="l00064"></a>00064 <span class="comment">#     </span>
<a name="l00065"></a>00065 <span class="keyword">def </span>is_gro_coord(line):
<a name="l00066"></a>00066     sline = line.split()
<a name="l00067"></a>00067     <span class="keywordflow">if</span> len(sline) == 6:
<a name="l00068"></a>00068         <span class="keywordflow">return</span> all([isint(sline[2]),isfloat(sline[3]),isfloat(sline[4]),isfloat(sline[5])])
<a name="l00069"></a>00069     <span class="keywordflow">elif</span> len(sline) == 5:
<a name="l00070"></a>00070         <span class="keywordflow">return</span> all([isint(line[15:20]),isfloat(sline[2]),isfloat(sline[3]),isfloat(sline[4])])
<a name="l00071"></a>00071     <span class="keywordflow">else</span>:
<a name="l00072"></a>00072         <span class="keywordflow">return</span> 0
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="comment">##</span>
<a name="l00075"></a>00075 <span class="comment">#  Determines whether a line contains CHARMM data or not</span>
<a name="l00076"></a>00076 <span class="comment"># </span>
<a name="l00077"></a>00077 <span class="comment">#     @param[in] line The line to be tested</span>
<a name="l00078"></a>00078 <span class="comment">#     </span>
<a name="l00079"></a>00079 <span class="comment">#     </span>
<a name="l00080"></a>00080 <span class="keyword">def </span>is_charmm_coord(line):
<a name="l00081"></a>00081     sline = line.split()
<a name="l00082"></a>00082     <span class="keywordflow">if</span> len(sline) &gt;= 7:
<a name="l00083"></a>00083         <span class="keywordflow">return</span> all([isint(sline[0]), isint(sline[1]), isfloat(sline[4]), isfloat(sline[5]), isfloat(sline[6])])
<a name="l00084"></a>00084     <span class="keywordflow">else</span>:
<a name="l00085"></a>00085         <span class="keywordflow">return</span> 0
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="comment">##</span>
<a name="l00088"></a>00088 <span class="comment">#  Determines whether a line contains a GROMACS box vector or not</span>
<a name="l00089"></a>00089 <span class="comment"># </span>
<a name="l00090"></a>00090 <span class="comment">#     @param[in] line The line to be tested</span>
<a name="l00091"></a>00091 <span class="comment">#     </span>
<a name="l00092"></a>00092 <span class="comment">#     </span>
<a name="l00093"></a>00093 <span class="keyword">def </span>is_gro_box(line):
<a name="l00094"></a>00094     sline = line.split()
<a name="l00095"></a>00095     <span class="keywordflow">if</span> len(sline) == 9 <span class="keywordflow">and</span> all([isfloat(i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> sline]):
<a name="l00096"></a>00096         <span class="keywordflow">return</span> 1
<a name="l00097"></a>00097     <span class="keywordflow">elif</span> len(sline) == 3 <span class="keywordflow">and</span> all([isfloat(i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> sline]):
<a name="l00098"></a>00098         <span class="keywordflow">return</span> 1
<a name="l00099"></a>00099     <span class="keywordflow">else</span>:
<a name="l00100"></a>00100         <span class="keywordflow">return</span> 0
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 <span class="comment">##</span>
<a name="l00103"></a>00103 <span class="comment">#  The Molecule class contains information about a system of molecules.</span>
<a name="l00104"></a>00104 <span class="comment"># </span>
<a name="l00105"></a>00105 <span class="comment">#     This is a centralized container of information that is useful for</span>
<a name="l00106"></a>00106 <span class="comment">#     file conversion and processing.  It is quite flexible but not</span>
<a name="l00107"></a>00107 <span class="comment">#     perfectly flexible.  For example, we can accommodate multiple sets</span>
<a name="l00108"></a>00108 <span class="comment">#     of xyz coordinates (i.e. multiple frames in a trajectory), but we</span>
<a name="l00109"></a>00109 <span class="comment">#     only allow a single set of atomic elements (i.e. can&#39;t have</span>
<a name="l00110"></a>00110 <span class="comment">#     molecules changing identities across frames.)</span>
<a name="l00111"></a>00111 <span class="comment"># </span>
<a name="l00112"></a>00112 <span class="comment">#     </span>
<a name="l00113"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html">00113</a> <span class="keyword">class </span><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html" title="The Molecule class contains information about a system of molecules.">Molecule</a>:
<a name="l00114"></a>00114     <span class="comment">##</span>
<a name="l00115"></a>00115     <span class="comment">#  To instantiate the class we simply define the table of file reading/writing functions</span>
<a name="l00116"></a>00116     <span class="comment">#         and read in a file if it is provided.</span>
<a name="l00117"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a3f8233f4e9911d7af0f17ca66c16ff92">00117</a>     <span class="keyword">def </span><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a3f8233f4e9911d7af0f17ca66c16ff92" title="To instantiate the class we simply define the table of file reading/writing functions and read in a f...">__init__</a>(self, fnm = None, ftype = None):
<a name="l00118"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ab812bbb4ae25ee4f6b69a7926a2ef3e8">00118</a>         
<a name="l00119"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a950a2ec0b5697bf88f192dec676825fc">00119</a>         <span class="comment">## The table of file readers</span>
<a name="l00120"></a>00120         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ab812bbb4ae25ee4f6b69a7926a2ef3e8" title="The table of file readers.">Read_Tab</a> = {<span class="stringliteral">&#39;com&#39;</span>:self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a861feda06e1f60ab25c45eaaaf228cfc" title="Parse a Gaussian .com file and return a SINGLE-ELEMENT list of xyz coordinates (no multiple file supp...">read_com</a>,
<a name="l00121"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a0e7014b94c6a4a477dc213c0a4e9ecd3">00121</a>                          <span class="stringliteral">&#39;gro&#39;</span>:self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a963a4382dc59ebd8dd9ee2064843e355" title="Read a GROMACS .gro file.">read_gro</a>,
<a name="l00122"></a>00122                          <span class="stringliteral">&#39;crd&#39;</span>:self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a8b8d3444945cab760288f28996787855" title="Read a CHARMM .cor (or .crd) file.">read_charmm</a>,
<a name="l00123"></a>00123                          <span class="stringliteral">&#39;cor&#39;</span>:self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a8b8d3444945cab760288f28996787855" title="Read a CHARMM .cor (or .crd) file.">read_charmm</a>,
<a name="l00124"></a>00124                          <span class="stringliteral">&#39;xyz&#39;</span>:self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a15a7a0e0377e6dfd52e60c77fbc583c1" title="Parse a .xyz file which contains several xyz coordinates, and return their elements.">read_xyz</a>,
<a name="l00125"></a>00125                          <span class="stringliteral">&#39;arc&#39;</span>:self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#aeb5983ae61079198f077f55e448e2c32" title="Read a TINKER .arc file.">read_arc</a>}
<a name="l00126"></a>00126         <span class="comment">## The table of file writers</span>
<a name="l00127"></a>00127         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a950a2ec0b5697bf88f192dec676825fc" title="The table of file writers.">Write_Tab</a> = {<span class="stringliteral">&#39;gro&#39;</span>:self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a503eae2cee228e4cc5fc736504714925">write_gro</a>,
<a name="l00128"></a>00128                           <span class="stringliteral">&#39;xyz&#39;</span>:self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#adc6620e8287edabe161442de12295f75">write_xyz</a>,
<a name="l00129"></a>00129                           <span class="stringliteral">&#39;in&#39;</span>:self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#af46b2ba6ef777cf8301bc16e157c724d" title="Write a Q-Chem input file from the template.">write_qcin</a>,
<a name="l00130"></a>00130                           <span class="stringliteral">&#39;arc&#39;</span>:self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a95782abfb36e7080a1b98bfad2ced4f3">write_arc</a>}
<a name="l00131"></a>00131         <span class="comment">## If supplied with a file name, read in stuff.</span>
<a name="l00132"></a>00132         <span class="keywordflow">if</span> fnm != <span class="keywordtype">None</span>:
<a name="l00133"></a>00133             self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ace88d617bf1029e9ff93c90904a2bef6" title="Read in a file.">read</a>(fnm, ftype)
<a name="l00134"></a>00134             
<a name="l00135"></a>00135         <span class="comment">## Initialize the index file here</span>
<a name="l00136"></a>00136         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a0e7014b94c6a4a477dc213c0a4e9ecd3" title="If supplied with a file name, read in stuff.">index</a> = {}
<a name="l00137"></a>00137 
<a name="l00138"></a>00138     <span class="comment">##</span>
<a name="l00139"></a>00139     <span class="comment">#  Read in a file.  This populates the attributes of the class.  For now, I don&#39;t know</span>
<a name="l00140"></a>00140     <span class="comment">#         what will happen if we read two files into the class.  Probably unexpected behavior will</span>
<a name="l00141"></a>00141     <span class="comment">#         occur.</span>
<a name="l00142"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ace88d617bf1029e9ff93c90904a2bef6">00142</a>     <span class="keyword">def </span><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ace88d617bf1029e9ff93c90904a2bef6" title="Read in a file.">read</a>(self, fnm, ftype = None):
<a name="l00143"></a>00143         <span class="keywordflow">if</span> ftype == <span class="keywordtype">None</span>:
<a name="l00144"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a9ebaaf7f5010d4efacd237aa81226416">00144</a>             <span class="comment">## File type can be determined from the file name using the extension.</span>
<a name="l00145"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ad651d4d57a6278a1ae9dfdd95a6d1b7d">00145</a>             ftype = fnm.split(<span class="stringliteral">&#39;.&#39;</span>)[-1]
<a name="l00146"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a11a61266093c37ae61131b685a152863">00146</a> 
<a name="l00147"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5e092c726455a18c9300f5c5362121d8">00147</a>         Answer = self.Read_Tab.get(ftype,self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a0dcb41e9e7e81c708e68f9442e68e0c4">oops</a>)(fnm)
<a name="l00148"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#aedc4ff9fd37b8c863b163df952422afa">00148</a> 
<a name="l00149"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4c424770f60335048f2ff496e5906dad">00149</a>         <span class="keywordflow">if</span> <span class="stringliteral">&#39;elem&#39;</span> <span class="keywordflow">in</span> Answer:
<a name="l00150"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ac84c67d37f00c0f65e6fb6126e19f9bb">00150</a>             <span class="comment">## Absolutely required; a list of chemical elements (number of atoms)</span>
<a name="l00151"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#afcd4c8e1671af626d0267a243e69530d">00151</a>             self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a9ebaaf7f5010d4efacd237aa81226416" title="File type can be determined from the file name using the extension.">elem</a>     = Answer[<span class="stringliteral">&#39;elem&#39;</span>]
<a name="l00152"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4aebc6ada9bda74a6740568d4f3658eb">00152</a>         <span class="keywordflow">else</span>:
<a name="l00153"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ab9ea84d9c71db7cdeea60970efd83f95">00153</a>             <span class="keywordflow">print</span> <span class="stringliteral">&quot;No list of elements! We cannot continue, blargggggh&quot;</span>
<a name="l00154"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a7f716ff1ac0ea6f513af301b15423bd0">00154</a>             exit(1)
<a name="l00155"></a>00155 
<a name="l00156"></a>00156         <span class="keywordflow">if</span> <span class="stringliteral">&#39;xyzs&#39;</span> <span class="keywordflow">in</span> Answer:
<a name="l00157"></a>00157             <span class="comment">## Absolutely required; a list of lists of xyz coordinates (number of frames x number of atoms)</span>
<a name="l00158"></a>00158             self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ad651d4d57a6278a1ae9dfdd95a6d1b7d" title="Absolutely required; a list of lists of xyz coordinates (number of frames x number of atoms)...">xyzs</a>     = Answer[<span class="stringliteral">&#39;xyzs&#39;</span>]
<a name="l00159"></a>00159             <span class="comment">## The number of snapshots is determined by the length of self.xyzs</span>
<a name="l00160"></a>00160             self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a11a61266093c37ae61131b685a152863" title="The number of snapshots is determined by the length of self.xyzs.">ns</a>       = len(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ad651d4d57a6278a1ae9dfdd95a6d1b7d" title="Absolutely required; a list of lists of xyz coordinates (number of frames x number of atoms)...">xyzs</a>)
<a name="l00161"></a>00161         <span class="keywordflow">else</span>:
<a name="l00162"></a>00162             <span class="keywordflow">print</span> <span class="stringliteral">&quot;No list of xyz coordinates! We cannot continue, eurk&quot;</span>
<a name="l00163"></a>00163             exit(1)
<a name="l00164"></a>00164 
<a name="l00165"></a>00165         <span class="keywordflow">if</span> <span class="stringliteral">&#39;comms&#39;</span> <span class="keywordflow">in</span> Answer:
<a name="l00166"></a>00166             <span class="comment">## The comments that usually go somewhere into the output file</span>
<a name="l00167"></a>00167             self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5e092c726455a18c9300f5c5362121d8" title="The comments that usually go somewhere into the output file.">comms</a>    = Answer[<span class="stringliteral">&#39;comms&#39;</span>]
<a name="l00168"></a>00168         <span class="keywordflow">else</span>:
<a name="l00169"></a>00169             <span class="keywordflow">print</span> <span class="stringliteral">&quot;No list of comments, making defaults&quot;</span>
<a name="l00170"></a>00170             self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5e092c726455a18c9300f5c5362121d8" title="The comments that usually go somewhere into the output file.">comms</a> = [<span class="stringliteral">&#39;Generated by filecnv.py from %s: frame %i of %i&#39;</span> % (fnm, i+1, self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a11a61266093c37ae61131b685a152863" title="The number of snapshots is determined by the length of self.xyzs.">ns</a>) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a11a61266093c37ae61131b685a152863" title="The number of snapshots is determined by the length of self.xyzs.">ns</a>)]
<a name="l00171"></a>00171 
<a name="l00172"></a>00172         <span class="comment">## Optional variable: the charge</span>
<a name="l00173"></a>00173         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#aedc4ff9fd37b8c863b163df952422afa" title="Optional variable: the charge.">charge</a> = Answer[<span class="stringliteral">&#39;charge&#39;</span>] <span class="keywordflow">if</span> <span class="stringliteral">&#39;charge&#39;</span> <span class="keywordflow">in</span> Answer <span class="keywordflow">else</span> <span class="keywordtype">None</span>
<a name="l00174"></a>00174         <span class="comment">## Optional variable: the multiplicity</span>
<a name="l00175"></a>00175         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4c424770f60335048f2ff496e5906dad" title="Optional variable: the multiplicity.">mult</a> = Answer[<span class="stringliteral">&#39;mult&#39;</span>] <span class="keywordflow">if</span> <span class="stringliteral">&#39;mult&#39;</span> <span class="keywordflow">in</span> Answer <span class="keywordflow">else</span> <span class="keywordtype">None</span>
<a name="l00176"></a>00176         <span class="comment">## Optional variable: the box vectors (there would be self.ns of these)</span>
<a name="l00177"></a>00177         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ac84c67d37f00c0f65e6fb6126e19f9bb" title="Optional variable: the box vectors (there would be self.ns of these)">boxes</a> = Answer[<span class="stringliteral">&#39;boxes&#39;</span>] <span class="keywordflow">if</span> <span class="stringliteral">&#39;boxes&#39;</span> <span class="keywordflow">in</span> Answer <span class="keywordflow">else</span> <span class="keywordtype">None</span>
<a name="l00178"></a>00178         <span class="comment">## Optional variable: the residue number</span>
<a name="l00179"></a>00179         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#afcd4c8e1671af626d0267a243e69530d" title="Optional variable: the residue number.">resid</a> = Answer[<span class="stringliteral">&#39;resid&#39;</span>] <span class="keywordflow">if</span> <span class="stringliteral">&#39;resid&#39;</span> <span class="keywordflow">in</span> Answer <span class="keywordflow">else</span> <span class="keywordtype">None</span>
<a name="l00180"></a>00180         <span class="comment">## Optional variable: the residue name</span>
<a name="l00181"></a>00181         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4aebc6ada9bda74a6740568d4f3658eb" title="Optional variable: the residue name.">resname</a> = Answer[<span class="stringliteral">&#39;resname&#39;</span>] <span class="keywordflow">if</span> <span class="stringliteral">&#39;resname&#39;</span> <span class="keywordflow">in</span> Answer <span class="keywordflow">else</span> <span class="keywordtype">None</span>
<a name="l00182"></a>00182         <span class="comment">## Optional variable: the atom name, which defaults to the elements</span>
<a name="l00183"></a>00183         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ab9ea84d9c71db7cdeea60970efd83f95" title="Optional variable: the atom name, which defaults to the elements.">atomname</a> = Answer[<span class="stringliteral">&#39;atomname&#39;</span>] <span class="keywordflow">if</span> <span class="stringliteral">&#39;atomname&#39;</span> <span class="keywordflow">in</span> Answer <span class="keywordflow">else</span> Answer[<span class="stringliteral">&#39;elem&#39;</span>]
<a name="l00184"></a>00184         <span class="comment">## Optional variable: raw .arc file in Tinker (because Tinker files are too hard to interpret!)</span>
<a name="l00185"></a>00185         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a7f716ff1ac0ea6f513af301b15423bd0" title="Optional variable: raw .arc file in Tinker (because Tinker files are too hard to interpret!)">rawarcs</a> = Answer[<span class="stringliteral">&#39;rawarcs&#39;</span>] <span class="keywordflow">if</span> <span class="stringliteral">&#39;rawarcs&#39;</span> <span class="keywordflow">in</span> Answer <span class="keywordflow">else</span> <span class="keywordtype">None</span>
<a name="l00186"></a>00186 
<a name="l00187"></a>00187     <span class="keyword">def </span>na(self):
<a name="l00188"></a>00188         <span class="keywordflow">return</span> len(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a9ebaaf7f5010d4efacd237aa81226416" title="File type can be determined from the file name using the extension.">elem</a>)
<a name="l00189"></a>00189 
<a name="l00190"></a>00190     <span class="keyword">def </span>write(self,fnm=None,ftype=None,append=False,tempfnm=None,subset=None):
<a name="l00191"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a373bac331c81cd969ee326b52d53f6ff">00191</a>         <span class="keywordflow">if</span> fnm == <span class="keywordtype">None</span> <span class="keywordflow">and</span> ftype == <span class="keywordtype">None</span>:
<a name="l00192"></a>00192             <span class="keywordflow">print</span> <span class="stringliteral">&quot;Without a file name or a file type, what do you expect me to do?&quot;</span>
<a name="l00193"></a>00193             exit(1)
<a name="l00194"></a>00194         <span class="keywordflow">elif</span> ftype == <span class="keywordtype">None</span>:
<a name="l00195"></a>00195             ftype = fnm.split(<span class="stringliteral">&quot;.&quot;</span>)[-1]
<a name="l00196"></a>00196 
<a name="l00197"></a>00197         <span class="comment">## Name of the template file</span>
<a name="l00198"></a>00198         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a373bac331c81cd969ee326b52d53f6ff" title="Name of the template file.">tempfnm</a> = tempfnm
<a name="l00199"></a>00199         out_lines = self.Write_Tab.get(ftype,self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a0dcb41e9e7e81c708e68f9442e68e0c4">oops</a>)(subset)
<a name="l00200"></a>00200 
<a name="l00201"></a>00201         <span class="keywordflow">if</span> fnm == <span class="keywordtype">None</span>:
<a name="l00202"></a>00202             outfile = stdout
<a name="l00203"></a>00203         <span class="keywordflow">elif</span> append:
<a name="l00204"></a>00204             outfile = open(fnm,<span class="stringliteral">&#39;a&#39;</span>)
<a name="l00205"></a>00205         <span class="keywordflow">else</span>:
<a name="l00206"></a>00206             outfile = open(fnm,<span class="stringliteral">&#39;w&#39;</span>)
<a name="l00207"></a>00207         <span class="keywordflow">for</span> line <span class="keywordflow">in</span> out_lines:
<a name="l00208"></a>00208             <span class="keywordflow">print</span> &gt;&gt; outfile,line
<a name="l00209"></a>00209         outfile.close()
<a name="l00210"></a>00210         
<a name="l00211"></a>00211     <span class="keyword">def </span>oops(self,fnm = None):
<a name="l00212"></a>00212         <span class="keywordflow">print</span> <span class="stringliteral">&quot;Yargh: Crashed when trying to %s&quot;</span> % (fnm == <span class="keywordtype">None</span> <span class="keywordflow">and</span> <span class="stringliteral">&quot;write&quot;</span> <span class="keywordflow">or</span> <span class="stringliteral">&quot;read %s&quot;</span> % fnm)
<a name="l00213"></a>00213         exit(1)
<a name="l00214"></a>00214 
<a name="l00215"></a>00215     <span class="comment">##</span>
<a name="l00216"></a>00216     <span class="comment">#  Parse a .xyz file which contains several xyz coordinates, and return their elements.</span>
<a name="l00217"></a>00217     <span class="comment"># </span>
<a name="l00218"></a>00218     <span class="comment">#         @param[in] fnm The input XYZ file name</span>
<a name="l00219"></a>00219     <span class="comment">#         @return elem  A list of chemical elements in the XYZ file</span>
<a name="l00220"></a>00220     <span class="comment">#         @return comms A list of comments.</span>
<a name="l00221"></a>00221     <span class="comment">#         @return xyzs  A list of XYZ coordinates (number of snapshots times number of atoms)</span>
<a name="l00222"></a>00222     <span class="comment"># </span>
<a name="l00223"></a>00223     <span class="comment">#         </span>
<a name="l00224"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a15a7a0e0377e6dfd52e60c77fbc583c1">00224</a>     <span class="keyword">def </span><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a15a7a0e0377e6dfd52e60c77fbc583c1" title="Parse a .xyz file which contains several xyz coordinates, and return their elements.">read_xyz</a>(self,fnm):
<a name="l00225"></a>00225         xyz   = []
<a name="l00226"></a>00226         xyzs  = []
<a name="l00227"></a>00227         comms = []
<a name="l00228"></a>00228         elem  = []
<a name="l00229"></a>00229         an    = 0
<a name="l00230"></a>00230         <span class="keywordflow">for</span> line <span class="keywordflow">in</span> open(fnm):
<a name="l00231"></a>00231             strip = line.strip()
<a name="l00232"></a>00232             sline = line.split()
<a name="l00233"></a>00233             <span class="keywordflow">if</span> match(<span class="stringliteral">&#39;^[0-9]+$&#39;</span>,strip):
<a name="l00234"></a>00234                 na = int(strip)
<a name="l00235"></a>00235             <span class="keywordflow">elif</span> match(<span class="stringliteral">&#39;[A-Z][a-z]*( +[-+]?([0-9]*\.[0-9]+|[0-9]+)){3}$&#39;</span>,strip):
<a name="l00236"></a>00236                 xyz.append([float(i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> sline[1:]])
<a name="l00237"></a>00237                 <span class="keywordflow">if</span> len(elem) &lt; na:
<a name="l00238"></a>00238                     elem.append(sline[0])
<a name="l00239"></a>00239                 an += 1
<a name="l00240"></a>00240                 <span class="keywordflow">if</span> an == na:
<a name="l00241"></a>00241                     xyzs.append(array(xyz))
<a name="l00242"></a>00242                     xyz = []
<a name="l00243"></a>00243                     an  = 0
<a name="l00244"></a>00244             <span class="keywordflow">elif</span> an == 0:
<a name="l00245"></a>00245                 comms.append(strip)
<a name="l00246"></a>00246         Answer = {<span class="stringliteral">&#39;elem&#39;</span> : elem,
<a name="l00247"></a>00247                   <span class="stringliteral">&#39;xyzs&#39;</span> : xyzs,
<a name="l00248"></a>00248                   <span class="stringliteral">&#39;comms&#39;</span>: comms}
<a name="l00249"></a>00249         <span class="keywordflow">return</span> Answer
<a name="l00250"></a>00250 
<a name="l00251"></a>00251     <span class="comment">##</span>
<a name="l00252"></a>00252     <span class="comment">#  Parse a Gaussian .com file and return a SINGLE-ELEMENT list of xyz coordinates (no multiple file support)</span>
<a name="l00253"></a>00253     <span class="comment"># </span>
<a name="l00254"></a>00254     <span class="comment">#         </span>
<a name="l00255"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a861feda06e1f60ab25c45eaaaf228cfc">00255</a>     <span class="keyword">def </span><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a861feda06e1f60ab25c45eaaaf228cfc" title="Parse a Gaussian .com file and return a SINGLE-ELEMENT list of xyz coordinates (no multiple file supp...">read_com</a>(self,fnm):
<a name="l00256"></a>00256         elem    = []
<a name="l00257"></a>00257         xyz     = []
<a name="l00258"></a>00258         ln      = 0
<a name="l00259"></a>00259         comfile = open(fnm).readlines()
<a name="l00260"></a>00260         inxyz = 0
<a name="l00261"></a>00261         <span class="keywordflow">for</span> line <span class="keywordflow">in</span> comfile:
<a name="l00262"></a>00262             <span class="comment"># Everything after exclamation point is a comment</span>
<a name="l00263"></a>00263             sline = line.split(<span class="stringliteral">&#39;!&#39;</span>)[0].split()
<a name="l00264"></a>00264             <span class="keywordflow">if</span> len(sline) == 2:
<a name="l00265"></a>00265                 <span class="keywordflow">if</span> isint(sline[0]) <span class="keywordflow">and</span> isint(sline[1]):
<a name="l00266"></a>00266                     charge = int(sline[0])
<a name="l00267"></a>00267                     mult = int(sline[1])
<a name="l00268"></a>00268                     title_ln = ln - 2
<a name="l00269"></a>00269             <span class="keywordflow">elif</span> len(sline) == 4:
<a name="l00270"></a>00270                 inxyz = 1
<a name="l00271"></a>00271                 <span class="keywordflow">if</span> sline[0].capitalize() <span class="keywordflow">in</span> PT <span class="keywordflow">and</span> isfloat(sline[1]) <span class="keywordflow">and</span> isfloat(sline[2]) <span class="keywordflow">and</span> isfloat(sline[3]):
<a name="l00272"></a>00272                     elem.append(sline[0])
<a name="l00273"></a>00273                     xyz.append(array([float(sline[1]),float(sline[2]),float(sline[3])]))
<a name="l00274"></a>00274             <span class="keywordflow">elif</span> inxyz:
<a name="l00275"></a>00275                 <span class="keywordflow">break</span>
<a name="l00276"></a>00276             ln += 1
<a name="l00277"></a>00277 
<a name="l00278"></a>00278         Answer = {<span class="stringliteral">&#39;xyzs&#39;</span>   : [array(xyz)],
<a name="l00279"></a>00279                   <span class="stringliteral">&#39;elem&#39;</span>   : elem,
<a name="l00280"></a>00280                   <span class="stringliteral">&#39;comms&#39;</span>  : [comfile[title_ln].strip()],
<a name="l00281"></a>00281                   <span class="stringliteral">&#39;charge&#39;</span> : charge,
<a name="l00282"></a>00282                   <span class="stringliteral">&#39;mult&#39;</span>   : mult}
<a name="l00283"></a>00283         <span class="keywordflow">return</span> Answer
<a name="l00284"></a>00284 
<a name="l00285"></a>00285     <span class="comment">##</span>
<a name="l00286"></a>00286     <span class="comment">#  Read a TINKER .arc file.</span>
<a name="l00287"></a>00287     <span class="comment">#         </span>
<a name="l00288"></a>00288     <span class="comment">#         </span>
<a name="l00289"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#aeb5983ae61079198f077f55e448e2c32">00289</a>     <span class="keyword">def </span><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#aeb5983ae61079198f077f55e448e2c32" title="Read a TINKER .arc file.">read_arc</a>(self,fnm):
<a name="l00290"></a>00290         rawarcs  = []
<a name="l00291"></a>00291         rawarc   = []
<a name="l00292"></a>00292         suffix   = []
<a name="l00293"></a>00293         xyzs  = []
<a name="l00294"></a>00294         xyz   = []
<a name="l00295"></a>00295         resid = []
<a name="l00296"></a>00296         elem  = []
<a name="l00297"></a>00297         comms = []
<a name="l00298"></a>00298         thisres = set([])
<a name="l00299"></a>00299         forwardres = set([])
<a name="l00300"></a>00300         title = <span class="keyword">True</span>
<a name="l00301"></a>00301         nframes = 0
<a name="l00302"></a>00302         thisresid   = 1
<a name="l00303"></a>00303         <span class="keywordflow">for</span> line <span class="keywordflow">in</span> open(fnm):
<a name="l00304"></a>00304             rawarc.append(line.strip())
<a name="l00305"></a>00305             sline = line.split()
<a name="l00306"></a>00306             <span class="comment"># The first line always contains the number of atoms</span>
<a name="l00307"></a>00307             <span class="keywordflow">if</span> title:
<a name="l00308"></a>00308                 na = int(sline[0])
<a name="l00309"></a>00309                 comms.append(<span class="stringliteral">&#39; &#39;</span>.join(sline[1:]))
<a name="l00310"></a>00310                 title = <span class="keyword">False</span>
<a name="l00311"></a>00311             <span class="keywordflow">elif</span> len(sline) &gt;= 6:
<a name="l00312"></a>00312                 <span class="comment">#print sline</span>
<a name="l00313"></a>00313                 <span class="keywordflow">if</span> isint(sline[0]) <span class="keywordflow">and</span> isfloat(sline[2]) <span class="keywordflow">and</span> isfloat(sline[3]) <span class="keywordflow">and</span> isfloat(sline[4]): <span class="comment"># A line of data better look like this</span>
<a name="l00314"></a>00314                     <span class="keywordflow">if</span> nframes == 0:
<a name="l00315"></a>00315                         elem.append(sline[1])
<a name="l00316"></a>00316                         resid.append(thisresid)
<a name="l00317"></a>00317                         whites      = split(<span class="stringliteral">&#39;[^ ]+&#39;</span>,line)
<a name="l00318"></a>00318                         <span class="keywordflow">if</span> len(sline) &gt; 5:
<a name="l00319"></a>00319                             suffix.append(<span class="stringliteral">&#39;&#39;</span>.join([whites[j]+sline[j] <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(5,len(sline))]))
<a name="l00320"></a>00320                         <span class="keywordflow">else</span>:
<a name="l00321"></a>00321                             suffix.append(<span class="stringliteral">&#39;&#39;</span>)
<a name="l00322"></a>00322                     thisatom = int(sline[0])
<a name="l00323"></a>00323                     thisres.add(thisatom)
<a name="l00324"></a>00324                     forwardres.add(thisatom)
<a name="l00325"></a>00325                     <span class="keywordflow">if</span> len(sline) &gt;= 6:
<a name="l00326"></a>00326                         forwardres.update([int(j) <span class="keywordflow">for</span> j <span class="keywordflow">in</span> sline[6:]])
<a name="l00327"></a>00327                     <span class="keywordflow">if</span> thisres == forwardres:
<a name="l00328"></a>00328                         thisres = set([])
<a name="l00329"></a>00329                         forwardres = set([])
<a name="l00330"></a>00330                         thisresid += 1
<a name="l00331"></a>00331                     xyz.append([float(sline[2]),float(sline[3]),float(sline[4])])
<a name="l00332"></a>00332                     <span class="keywordflow">if</span> thisatom == na:
<a name="l00333"></a>00333                         nframes += 1
<a name="l00334"></a>00334                         title = <span class="keyword">True</span>
<a name="l00335"></a>00335                         xyzs.append(array(xyz))
<a name="l00336"></a>00336                         xyz = []
<a name="l00337"></a>00337                         rawarcs.append(list(rawarc))
<a name="l00338"></a>00338                         rawarc = []
<a name="l00339"></a>00339                 <span class="keywordflow">else</span>:
<a name="l00340"></a>00340                     <span class="keywordflow">print</span> <span class="stringliteral">&quot;What is this line?  It isn&#39;t data&quot;</span>
<a name="l00341"></a>00341                     <span class="keywordflow">print</span> line,
<a name="l00342"></a>00342                     exit()
<a name="l00343"></a>00343         Answer = {<span class="stringliteral">&#39;xyzs&#39;</span>   : xyzs,
<a name="l00344"></a>00344                   <span class="stringliteral">&#39;resid&#39;</span>  : resid,
<a name="l00345"></a>00345                   <span class="stringliteral">&#39;elem&#39;</span>   : elem,
<a name="l00346"></a>00346                   <span class="stringliteral">&#39;comms&#39;</span>  : comms,
<a name="l00347"></a>00347                   <span class="stringliteral">&#39;rawarcs&#39;</span>: rawarcs,
<a name="l00348"></a>00348                   <span class="stringliteral">&#39;suffix&#39;</span> : suffix}
<a name="l00349"></a>00349         <span class="keywordflow">return</span> Answer
<a name="l00350"></a>00350 
<a name="l00351"></a>00351     <span class="comment">##</span>
<a name="l00352"></a>00352     <span class="comment">#  Read an index.ndx file and add an entry to the dictionary</span>
<a name="l00353"></a>00353     <span class="comment">#         {&#39;index_name&#39;: [ num1, num2, num3 .. ]}</span>
<a name="l00354"></a>00354     <span class="comment">#         </span>
<a name="l00355"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a0c70b2ad42c34ec5aadad92f9567359e">00355</a>     <span class="keyword">def </span><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a0c70b2ad42c34ec5aadad92f9567359e" title="Read an index.ndx file and add an entry to the dictionary {&#39;index_name&#39;: [ num1, num2, num3 .">read_ndx</a>(self, fnm):
<a name="l00356"></a>00356 
<a name="l00357"></a>00357         section = <span class="keywordtype">None</span>
<a name="l00358"></a>00358         <span class="keywordflow">for</span> line <span class="keywordflow">in</span> open(fnm):
<a name="l00359"></a>00359             line = line.strip()
<a name="l00360"></a>00360             s = line.split()
<a name="l00361"></a>00361             <span class="keywordflow">if</span> match(<span class="stringliteral">&#39;^\[.*\]&#39;</span>,line):
<a name="l00362"></a>00362                 section = sub(<span class="stringliteral">&#39;[\[\] \n]&#39;</span>,<span class="stringliteral">&#39;&#39;</span>,line)
<a name="l00363"></a>00363             <span class="keywordflow">elif</span> all([isint(i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> s]):
<a name="l00364"></a>00364                 <span class="keywordflow">for</span> j <span class="keywordflow">in</span> s:
<a name="l00365"></a>00365                     self.index.setdefault(section,[]).append(int(j)-1)
<a name="l00366"></a>00366 
<a name="l00367"></a>00367     <span class="comment">##</span>
<a name="l00368"></a>00368     <span class="comment">#  Reorders an xyz file using data provided from an .ndx file. </span>
<a name="l00369"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a608fcc36be068622000110cdf18f2452">00369</a>     <span class="keyword">def </span><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a608fcc36be068622000110cdf18f2452" title="Reorders an xyz file using data provided from an .ndx file.">reorder</a>(self, idx_name=None):
<a name="l00370"></a>00370         
<a name="l00371"></a>00371         <span class="keywordflow">if</span> idx_name <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a0e7014b94c6a4a477dc213c0a4e9ecd3" title="If supplied with a file name, read in stuff.">index</a>:
<a name="l00372"></a>00372             <span class="keywordflow">print</span> <span class="stringliteral">&quot;ARGHH, %s doesn&#39;t exist in the index&quot;</span> % idx_name
<a name="l00373"></a>00373             exit(1)
<a name="l00374"></a>00374 
<a name="l00375"></a>00375         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a90fe456919fda305703e36af389e60e1">require_resid</a>()
<a name="l00376"></a>00376         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ad47d05a3ea76e013a628bd7b25ae3050">require_resname</a>()
<a name="l00377"></a>00377 
<a name="l00378"></a>00378         newatomname = list(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ab9ea84d9c71db7cdeea60970efd83f95" title="Optional variable: the atom name, which defaults to the elements.">atomname</a>)
<a name="l00379"></a>00379         newelem = list(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a9ebaaf7f5010d4efacd237aa81226416" title="File type can be determined from the file name using the extension.">elem</a>)
<a name="l00380"></a>00380         newresid = list(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#afcd4c8e1671af626d0267a243e69530d" title="Optional variable: the residue number.">resid</a>)
<a name="l00381"></a>00381         newresname = list(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4aebc6ada9bda74a6740568d4f3658eb" title="Optional variable: the residue name.">resname</a>)
<a name="l00382"></a>00382         <span class="keywordflow">for</span> an, assign <span class="keywordflow">in</span> enumerate(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a0e7014b94c6a4a477dc213c0a4e9ecd3" title="If supplied with a file name, read in stuff.">index</a>[idx_name]):
<a name="l00383"></a>00383             newatomname[an] = self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ab9ea84d9c71db7cdeea60970efd83f95" title="Optional variable: the atom name, which defaults to the elements.">atomname</a>[assign]
<a name="l00384"></a>00384             newelem[an] = self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a9ebaaf7f5010d4efacd237aa81226416" title="File type can be determined from the file name using the extension.">elem</a>[assign]
<a name="l00385"></a>00385             newresid[an] = self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#afcd4c8e1671af626d0267a243e69530d" title="Optional variable: the residue number.">resid</a>[assign]
<a name="l00386"></a>00386             newresname[an] = self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4aebc6ada9bda74a6740568d4f3658eb" title="Optional variable: the residue name.">resname</a>[assign]
<a name="l00387"></a>00387         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ab9ea84d9c71db7cdeea60970efd83f95" title="Optional variable: the atom name, which defaults to the elements.">atomname</a> = list(newatomname)
<a name="l00388"></a>00388         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a9ebaaf7f5010d4efacd237aa81226416" title="File type can be determined from the file name using the extension.">elem</a> = list(newelem)
<a name="l00389"></a>00389         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#afcd4c8e1671af626d0267a243e69530d" title="Optional variable: the residue number.">resid</a> = list(newresid)
<a name="l00390"></a>00390         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4aebc6ada9bda74a6740568d4f3658eb" title="Optional variable: the residue name.">resname</a> = list(newresname)
<a name="l00391"></a>00391 
<a name="l00392"></a>00392         <span class="keywordflow">for</span> sn, xyz <span class="keywordflow">in</span> enumerate(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ad651d4d57a6278a1ae9dfdd95a6d1b7d" title="Absolutely required; a list of lists of xyz coordinates (number of frames x number of atoms)...">xyzs</a>):
<a name="l00393"></a>00393             newxyz = xyz.copy()
<a name="l00394"></a>00394             <span class="keywordflow">for</span> an, assign <span class="keywordflow">in</span> enumerate(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a0e7014b94c6a4a477dc213c0a4e9ecd3" title="If supplied with a file name, read in stuff.">index</a>[idx_name]):
<a name="l00395"></a>00395                 newxyz[an] = xyz[assign]
<a name="l00396"></a>00396             self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ad651d4d57a6278a1ae9dfdd95a6d1b7d" title="Absolutely required; a list of lists of xyz coordinates (number of frames x number of atoms)...">xyzs</a>[sn] = newxyz.copy()
<a name="l00397"></a>00397             
<a name="l00398"></a>00398             
<a name="l00399"></a>00399     <span class="comment">##</span>
<a name="l00400"></a>00400     <span class="comment">#  Read a GROMACS .gro file.</span>
<a name="l00401"></a>00401     <span class="comment"># </span>
<a name="l00402"></a>00402     <span class="comment">#         </span>
<a name="l00403"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a963a4382dc59ebd8dd9ee2064843e355">00403</a>     <span class="keyword">def </span><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a963a4382dc59ebd8dd9ee2064843e355" title="Read a GROMACS .gro file.">read_gro</a>(self, fnm):
<a name="l00404"></a>00404         xyzs     = []
<a name="l00405"></a>00405         elem     = [] <span class="comment"># The element, most useful for quantum chemistry calculations</span>
<a name="l00406"></a>00406         atomname = [] <span class="comment"># The atom name, for instance &#39;HW1&#39;</span>
<a name="l00407"></a>00407         comms    = []
<a name="l00408"></a>00408         resid    = []
<a name="l00409"></a>00409         resname  = []
<a name="l00410"></a>00410         boxes    = []
<a name="l00411"></a>00411         xyz      = []
<a name="l00412"></a>00412         ln       = 0
<a name="l00413"></a>00413         frame    = 0
<a name="l00414"></a>00414         <span class="keywordflow">for</span> line <span class="keywordflow">in</span> open(fnm):
<a name="l00415"></a>00415             sline = line.split()
<a name="l00416"></a>00416             <span class="keywordflow">if</span> ln == 0:
<a name="l00417"></a>00417                 comms.append(line.strip())
<a name="l00418"></a>00418             <span class="keywordflow">elif</span> ln == 1:
<a name="l00419"></a>00419                 na = int(line.strip())
<a name="l00420"></a>00420             <span class="keywordflow">elif</span> is_gro_coord(line):
<a name="l00421"></a>00421                 <span class="keywordflow">if</span> frame == 0: <span class="comment"># Create the list of residues, atom names etc. only if it&#39;s the first frame.</span>
<a name="l00422"></a>00422                     <span class="comment"># Name of the residue, for instance &#39;153SOL1 -&gt; SOL1&#39; ; strips leading numbers</span>
<a name="l00423"></a>00423                     thisresname = sub(<span class="stringliteral">&#39;^[0-9]*&#39;</span>,<span class="stringliteral">&#39;&#39;</span>,sline[0])
<a name="l00424"></a>00424                     resname.append(thisresname)
<a name="l00425"></a>00425                     resid.append(int(sline[0].replace(thisresname,<span class="stringliteral">&#39;&#39;</span>)))
<a name="l00426"></a>00426                     atomname.append(sline[1])
<a name="l00427"></a>00427                     thiselem = sline[1]
<a name="l00428"></a>00428                     <span class="keywordflow">if</span> len(thiselem) &gt; 1:
<a name="l00429"></a>00429                         thiselem = thiselem[0] + sub(<span class="stringliteral">&#39;[A-Z0-9]&#39;</span>,<span class="stringliteral">&#39;&#39;</span>,thiselem[1:])
<a name="l00430"></a>00430                     elem.append(thiselem)
<a name="l00431"></a>00431                 xyz.append([float(i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> sline[-3:]])
<a name="l00432"></a>00432             <span class="keywordflow">elif</span> is_gro_box(line) <span class="keywordflow">and</span> ln == na + 2:
<a name="l00433"></a>00433                 boxes.append([float(i)*10 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> sline])
<a name="l00434"></a>00434                 xyzs.append(array(xyz)*10)
<a name="l00435"></a>00435                 xyz = []
<a name="l00436"></a>00436                 ln = -1
<a name="l00437"></a>00437                 frame += 1
<a name="l00438"></a>00438             <span class="keywordflow">else</span>:
<a name="l00439"></a>00439                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;AHOOOOOGA, I encountered a line I didn&#39;t expect!&quot;</span>
<a name="l00440"></a>00440                 <span class="keywordflow">print</span> line
<a name="l00441"></a>00441             ln += 1
<a name="l00442"></a>00442         Answer = {<span class="stringliteral">&#39;xyzs&#39;</span>     : xyzs,
<a name="l00443"></a>00443                   <span class="stringliteral">&#39;elem&#39;</span>     : elem,
<a name="l00444"></a>00444                   <span class="stringliteral">&#39;atomname&#39;</span> : atomname,
<a name="l00445"></a>00445                   <span class="stringliteral">&#39;resid&#39;</span>    : resid,
<a name="l00446"></a>00446                   <span class="stringliteral">&#39;resname&#39;</span>  : resname,
<a name="l00447"></a>00447                   <span class="stringliteral">&#39;boxes&#39;</span>    : boxes,
<a name="l00448"></a>00448                   <span class="stringliteral">&#39;comms&#39;</span>    : comms}
<a name="l00449"></a>00449         <span class="keywordflow">return</span> Answer
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     <span class="comment">##</span>
<a name="l00452"></a>00452     <span class="comment">#  Read a CHARMM .cor (or .crd) file.</span>
<a name="l00453"></a>00453     <span class="comment"># </span>
<a name="l00454"></a>00454     <span class="comment">#         </span>
<a name="l00455"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a8b8d3444945cab760288f28996787855">00455</a>     <span class="keyword">def </span><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a8b8d3444945cab760288f28996787855" title="Read a CHARMM .cor (or .crd) file.">read_charmm</a>(self, fnm):
<a name="l00456"></a>00456         xyzs     = []
<a name="l00457"></a>00457         elem     = [] <span class="comment"># The element, most useful for quantum chemistry calculations</span>
<a name="l00458"></a>00458         atomname = [] <span class="comment"># The atom name, for instance &#39;HW1&#39;</span>
<a name="l00459"></a>00459         comms    = []
<a name="l00460"></a>00460         resid    = []
<a name="l00461"></a>00461         resname  = []
<a name="l00462"></a>00462         xyz      = []
<a name="l00463"></a>00463         thiscomm = []
<a name="l00464"></a>00464         ln       = 0
<a name="l00465"></a>00465         frame    = 0
<a name="l00466"></a>00466         an       = 0
<a name="l00467"></a>00467         <span class="keywordflow">for</span> line <span class="keywordflow">in</span> open(fnm):
<a name="l00468"></a>00468             sline = line.split()
<a name="l00469"></a>00469             <span class="keywordflow">if</span> match(<span class="stringliteral">&#39;^\*&#39;</span>,line):
<a name="l00470"></a>00470                 <span class="keywordflow">if</span> len(sline) == 1:
<a name="l00471"></a>00471                     comms.append(<span class="stringliteral">&#39;;&#39;</span>.join(list(thiscomm)))
<a name="l00472"></a>00472                     thiscomm = []
<a name="l00473"></a>00473                 <span class="keywordflow">else</span>:
<a name="l00474"></a>00474                     thiscomm.append(<span class="stringliteral">&#39; &#39;</span>.join(sline[1:]))
<a name="l00475"></a>00475             <span class="keywordflow">elif</span> match(<span class="stringliteral">&#39;^ *[0-9]+ +(EXT)?$&#39;</span>,line):
<a name="l00476"></a>00476                 na = int(sline[0])
<a name="l00477"></a>00477             <span class="keywordflow">elif</span> is_charmm_coord(line):
<a name="l00478"></a>00478                 <span class="keywordflow">if</span> frame == 0: <span class="comment"># Create the list of residues, atom names etc. only if it&#39;s the first frame.</span>
<a name="l00479"></a>00479                     resid.append(sline[1])
<a name="l00480"></a>00480                     resname.append(sline[2])
<a name="l00481"></a>00481                     atomname.append(sline[3])
<a name="l00482"></a>00482                     thiselem = sline[3]
<a name="l00483"></a>00483                     <span class="keywordflow">if</span> len(thiselem) &gt; 1:
<a name="l00484"></a>00484                         thiselem = thiselem[0] + sub(<span class="stringliteral">&#39;[A-Z0-9]&#39;</span>,<span class="stringliteral">&#39;&#39;</span>,thiselem[1:])
<a name="l00485"></a>00485                     elem.append(thiselem)
<a name="l00486"></a>00486                 xyz.append([float(i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> sline[4:7]])
<a name="l00487"></a>00487                 an += 1
<a name="l00488"></a>00488                 <span class="keywordflow">if</span> an == na:
<a name="l00489"></a>00489                     xyzs.append(array(xyz))
<a name="l00490"></a>00490                     xyz = []
<a name="l00491"></a>00491                     an = 0
<a name="l00492"></a>00492                     frame += 1
<a name="l00493"></a>00493             ln += 1
<a name="l00494"></a>00494         Answer = {<span class="stringliteral">&#39;xyzs&#39;</span>     : xyzs,
<a name="l00495"></a>00495                   <span class="stringliteral">&#39;elem&#39;</span>     : elem,
<a name="l00496"></a>00496                   <span class="stringliteral">&#39;atomname&#39;</span> : atomname,
<a name="l00497"></a>00497                   <span class="stringliteral">&#39;resid&#39;</span>    : resid,
<a name="l00498"></a>00498                   <span class="stringliteral">&#39;resname&#39;</span>  : resname,
<a name="l00499"></a>00499                   <span class="stringliteral">&#39;comms&#39;</span>    : comms}
<a name="l00500"></a>00500         <span class="keywordflow">return</span> Answer
<a name="l00501"></a>00501 
<a name="l00502"></a>00502     <span class="comment">##</span>
<a name="l00503"></a>00503     <span class="comment"># Write a Q-Chem input file from the template.</span>
<a name="l00504"></a>00504     <span class="comment"># </span>
<a name="l00505"></a>00505     <span class="comment">#         </span>
<a name="l00506"></a><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#af46b2ba6ef777cf8301bc16e157c724d">00506</a>     <span class="keyword">def </span><a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#af46b2ba6ef777cf8301bc16e157c724d" title="Write a Q-Chem input file from the template.">write_qcin</a>(self, subset = None):
<a name="l00507"></a>00507         
<a name="l00508"></a>00508         <span class="keywordflow">if</span> self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a373bac331c81cd969ee326b52d53f6ff" title="Name of the template file.">tempfnm</a> == <span class="keywordtype">None</span>:
<a name="l00509"></a>00509             self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a373bac331c81cd969ee326b52d53f6ff" title="Name of the template file.">tempfnm</a> = <span class="stringliteral">&quot;qtemp.in&quot;</span>
<a name="l00510"></a>00510 
<a name="l00511"></a>00511         got_mol   = <span class="keyword">False</span>
<a name="l00512"></a>00512         got_comm  = <span class="keyword">False</span>
<a name="l00513"></a>00513         active    = <span class="keyword">True</span>
<a name="l00514"></a>00514         bas_sect  = <span class="keyword">False</span>
<a name="l00515"></a>00515 
<a name="l00516"></a>00516         out = []
<a name="l00517"></a>00517         temp_lines = []
<a name="l00518"></a>00518         ln = 0
<a name="l00519"></a>00519         xyz_insert = 0
<a name="l00520"></a>00520         comm_insert = 0
<a name="l00521"></a>00521         <span class="keywordflow">for</span> line <span class="keywordflow">in</span> open(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a373bac331c81cd969ee326b52d53f6ff" title="Name of the template file.">tempfnm</a>).readlines():
<a name="l00522"></a>00522             line = line.strip()
<a name="l00523"></a>00523             sline = line.split()
<a name="l00524"></a>00524             <span class="keywordflow">if</span> match(<span class="stringliteral">&#39;^\$&#39;</span>,line):
<a name="l00525"></a>00525                 wrd = sub(<span class="stringliteral">&#39;\$&#39;</span>,<span class="stringliteral">&#39;&#39;</span>,line)
<a name="l00526"></a>00526                 <span class="keywordflow">if</span> wrd == <span class="stringliteral">&#39;end&#39;</span>:
<a name="l00527"></a>00527                     active = <span class="keyword">True</span>
<a name="l00528"></a>00528                     bas_sect = <span class="keyword">False</span>
<a name="l00529"></a>00529             <span class="keywordflow">elif</span> wrd == <span class="stringliteral">&#39;molecule&#39;</span>:
<a name="l00530"></a>00530                 <span class="keywordflow">if</span> got_mol: <span class="keywordflow">pass</span>
<a name="l00531"></a>00531                 got_mol = <span class="keyword">True</span>
<a name="l00532"></a>00532                 <span class="keywordflow">if</span> match(<span class="stringliteral">&quot;[+-]?[0-9]+ +[0-9]+$&quot;</span>,line.split(<span class="stringliteral">&#39;!&#39;</span>)[0].strip()):
<a name="l00533"></a>00533                     <span class="keywordflow">if</span> xyz_insert == 0:
<a name="l00534"></a>00534                         xyz_insert = ln
<a name="l00535"></a>00535                     <span class="keywordflow">if</span> active <span class="keywordflow">and</span> self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#aedc4ff9fd37b8c863b163df952422afa" title="Optional variable: the charge.">charge</a> == <span class="keywordtype">None</span> <span class="keywordflow">and</span> self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4c424770f60335048f2ff496e5906dad" title="Optional variable: the multiplicity.">mult</a> == <span class="keywordtype">None</span>:
<a name="l00536"></a>00536                         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#aedc4ff9fd37b8c863b163df952422afa" title="Optional variable: the charge.">charge</a> = int(sline[0])
<a name="l00537"></a>00537                         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4c424770f60335048f2ff496e5906dad" title="Optional variable: the multiplicity.">mult</a> = int(sline[1])
<a name="l00538"></a>00538                     active = <span class="keyword">False</span>
<a name="l00539"></a>00539             <span class="keywordflow">elif</span> wrd == <span class="stringliteral">&#39;comment&#39;</span>:
<a name="l00540"></a>00540                 <span class="keywordflow">if</span> got_comm: <span class="keywordflow">pass</span>
<a name="l00541"></a>00541                 got_comm = <span class="keyword">True</span>
<a name="l00542"></a>00542                 <span class="keywordflow">if</span> comm_insert == 0:
<a name="l00543"></a>00543                     comm_insert = ln
<a name="l00544"></a>00544             <span class="keywordflow">elif</span> wrd == <span class="stringliteral">&#39;basis&#39;</span>:
<a name="l00545"></a>00545                 bas_sect = <span class="keyword">True</span>
<a name="l00546"></a>00546             <span class="keywordflow">if</span> active:
<a name="l00547"></a>00547                 <span class="keywordflow">if</span> bas_sect:
<a name="l00548"></a>00548                     line = line.split(<span class="stringliteral">&#39;!&#39;</span>)[0]
<a name="l00549"></a>00549                 temp_lines.append(line)
<a name="l00550"></a>00550                 ln += 1
<a name="l00551"></a>00551                 
<a name="l00552"></a>00552             <span class="keywordflow">if</span> match(<span class="stringliteral">&#39;^@$&#39;</span>, line):
<a name="l00553"></a>00553                 have_ats = 1
<a name="l00554"></a>00554             <span class="keywordflow">elif</span> len(sline) != 0:
<a name="l00555"></a>00555                 have_ats = 0
<a name="l00556"></a>00556 
<a name="l00557"></a>00557         <span class="keywordflow">for</span> I, xyz <span class="keywordflow">in</span> enumerate(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ad651d4d57a6278a1ae9dfdd95a6d1b7d" title="Absolutely required; a list of lists of xyz coordinates (number of frames x number of atoms)...">xyzs</a>):
<a name="l00558"></a>00558             <span class="keywordflow">if</span> subset != <span class="keywordtype">None</span> <span class="keywordflow">and</span> I <span class="keywordflow">not</span> <span class="keywordflow">in</span> subset: <span class="keywordflow">continue</span>
<a name="l00559"></a>00559             <span class="keywordflow">for</span> ln, line <span class="keywordflow">in</span> enumerate(temp_lines):
<a name="l00560"></a>00560                 <span class="keywordflow">if</span> ln == xyz_insert:
<a name="l00561"></a>00561                     out.append(<span class="stringliteral">&quot;%i %i&quot;</span> % (self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#aedc4ff9fd37b8c863b163df952422afa" title="Optional variable: the charge.">charge</a>, self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4c424770f60335048f2ff496e5906dad" title="Optional variable: the multiplicity.">mult</a>))
<a name="l00562"></a>00562                     <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5d4d6bacac17decec84355c2b31d0834">na</a>()):
<a name="l00563"></a>00563                         out.append(format_xyz_coord(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a9ebaaf7f5010d4efacd237aa81226416" title="File type can be determined from the file name using the extension.">elem</a>[i],xyz[i]))
<a name="l00564"></a>00564                 <span class="keywordflow">elif</span> ln == comm_insert:
<a name="l00565"></a>00565                     out.append(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5e092c726455a18c9300f5c5362121d8" title="The comments that usually go somewhere into the output file.">comms</a>[I])
<a name="l00566"></a>00566                 out.append(line)
<a name="l00567"></a>00567             <span class="keywordflow">if</span> I &lt; len(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ad651d4d57a6278a1ae9dfdd95a6d1b7d" title="Absolutely required; a list of lists of xyz coordinates (number of frames x number of atoms)...">xyzs</a>) - 1 <span class="keywordflow">and</span> have_ats == 0:
<a name="l00568"></a>00568                 out.append(<span class="stringliteral">&#39;&#39;</span>)
<a name="l00569"></a>00569                 out.append(<span class="stringliteral">&#39;@@@@&#39;</span>)
<a name="l00570"></a>00570                 out.append(<span class="stringliteral">&#39;&#39;</span>)
<a name="l00571"></a>00571             
<a name="l00572"></a>00572         <span class="keywordflow">return</span> out
<a name="l00573"></a>00573 
<a name="l00574"></a>00574     <span class="keyword">def </span>write_xyz(self, subset = None):
<a name="l00575"></a>00575         out = []
<a name="l00576"></a>00576         <span class="keywordflow">for</span> I, xyz <span class="keywordflow">in</span> enumerate(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ad651d4d57a6278a1ae9dfdd95a6d1b7d" title="Absolutely required; a list of lists of xyz coordinates (number of frames x number of atoms)...">xyzs</a>):
<a name="l00577"></a>00577             <span class="keywordflow">if</span> subset != <span class="keywordtype">None</span> <span class="keywordflow">and</span> I <span class="keywordflow">not</span> <span class="keywordflow">in</span> subset: <span class="keywordflow">continue</span>
<a name="l00578"></a>00578             out.append(<span class="stringliteral">&quot;%-5i&quot;</span> % self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5d4d6bacac17decec84355c2b31d0834">na</a>())
<a name="l00579"></a>00579             out.append(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5e092c726455a18c9300f5c5362121d8" title="The comments that usually go somewhere into the output file.">comms</a>[I])
<a name="l00580"></a>00580             <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5d4d6bacac17decec84355c2b31d0834">na</a>()):
<a name="l00581"></a>00581                 out.append(format_xyz_coord(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a9ebaaf7f5010d4efacd237aa81226416" title="File type can be determined from the file name using the extension.">elem</a>[i],xyz[i]))
<a name="l00582"></a>00582         <span class="keywordflow">return</span> out
<a name="l00583"></a>00583 
<a name="l00584"></a>00584     <span class="keyword">def </span>write_arc(self, subset = None):
<a name="l00585"></a>00585         out = []
<a name="l00586"></a>00586         <span class="keywordflow">if</span> self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a7f716ff1ac0ea6f513af301b15423bd0" title="Optional variable: raw .arc file in Tinker (because Tinker files are too hard to interpret!)">rawarcs</a> == <span class="keywordtype">None</span>:
<a name="l00587"></a>00587             <span class="keywordflow">if</span> self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a373bac331c81cd969ee326b52d53f6ff" title="Name of the template file.">tempfnm</a> != <span class="keywordtype">None</span>:
<a name="l00588"></a>00588                 suffix = self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#aeb5983ae61079198f077f55e448e2c32" title="Read a TINKER .arc file.">read_arc</a>(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a373bac331c81cd969ee326b52d53f6ff" title="Name of the template file.">tempfnm</a>)[<span class="stringliteral">&#39;suffix&#39;</span>]
<a name="l00589"></a>00589                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Taking topology from template .arc file&quot;</span>
<a name="l00590"></a>00590             <span class="keywordflow">else</span>:
<a name="l00591"></a>00591                 suffix = [<span class="stringliteral">&#39;&#39;</span> <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5d4d6bacac17decec84355c2b31d0834">na</a>())]
<a name="l00592"></a>00592                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Beware, this .arc file contains no atom type or topology info (to do that, you need an .arc file as the third argument&quot;</span>
<a name="l00593"></a>00593             <span class="keywordflow">for</span> I, xyz <span class="keywordflow">in</span> enumerate(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ad651d4d57a6278a1ae9dfdd95a6d1b7d" title="Absolutely required; a list of lists of xyz coordinates (number of frames x number of atoms)...">xyzs</a>):
<a name="l00594"></a>00594                 <span class="keywordflow">if</span> subset != <span class="keywordtype">None</span> <span class="keywordflow">and</span> I <span class="keywordflow">not</span> <span class="keywordflow">in</span> subset: <span class="keywordflow">continue</span>
<a name="l00595"></a>00595                 out.append(<span class="stringliteral">&quot;%6i  %s&quot;</span> % (self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5d4d6bacac17decec84355c2b31d0834">na</a>(), self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5e092c726455a18c9300f5c5362121d8" title="The comments that usually go somewhere into the output file.">comms</a>[I]))
<a name="l00596"></a>00596                 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5d4d6bacac17decec84355c2b31d0834">na</a>()):
<a name="l00597"></a>00597                     out.append(<span class="stringliteral">&quot;%6i  %s%s&quot;</span> % (i+1,format_xyz_coord(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a9ebaaf7f5010d4efacd237aa81226416" title="File type can be determined from the file name using the extension.">elem</a>[i],xyz[i],tinker=<span class="keyword">True</span>),suffix[i]))
<a name="l00598"></a>00598         <span class="keywordflow">else</span>:
<a name="l00599"></a>00599             <span class="keywordflow">for</span> I, rawarc <span class="keywordflow">in</span> enumerate(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a7f716ff1ac0ea6f513af301b15423bd0" title="Optional variable: raw .arc file in Tinker (because Tinker files are too hard to interpret!)">rawarcs</a>):
<a name="l00600"></a>00600                 <span class="keywordflow">if</span> subset != <span class="keywordtype">None</span> <span class="keywordflow">and</span> I <span class="keywordflow">not</span> <span class="keywordflow">in</span> subset: <span class="keywordflow">continue</span>
<a name="l00601"></a>00601                 out += rawarc
<a name="l00602"></a>00602         <span class="keywordflow">return</span> out
<a name="l00603"></a>00603 
<a name="l00604"></a>00604     <span class="keyword">def </span>write_gro(self, subset = None):
<a name="l00605"></a>00605         out = []
<a name="l00606"></a>00606         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ad47d05a3ea76e013a628bd7b25ae3050">require_resname</a>()
<a name="l00607"></a>00607         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a90fe456919fda305703e36af389e60e1">require_resid</a>()
<a name="l00608"></a>00608         self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a03af3cfb99ea8f1c8c7e93d04bdcf967">require_boxes</a>()
<a name="l00609"></a>00609 
<a name="l00610"></a>00610         <span class="comment"># LPW I need to implement a more general template reader.</span>
<a name="l00611"></a>00611         <span class="comment"># if self.tempfnm != None:</span>
<a name="l00612"></a>00612         <span class="comment">#     GroTmp = self.read_gro(self.tempfnm)</span>
<a name="l00613"></a>00613         <span class="comment">#     print GroTmp[&#39;elem&#39;]</span>
<a name="l00614"></a>00614 
<a name="l00615"></a>00615         <span class="keywordflow">for</span> I, xyz <span class="keywordflow">in</span> enumerate(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ad651d4d57a6278a1ae9dfdd95a6d1b7d" title="Absolutely required; a list of lists of xyz coordinates (number of frames x number of atoms)...">xyzs</a>):
<a name="l00616"></a>00616             <span class="keywordflow">if</span> subset != <span class="keywordtype">None</span> <span class="keywordflow">and</span> I <span class="keywordflow">not</span> <span class="keywordflow">in</span> subset: <span class="keywordflow">continue</span>
<a name="l00617"></a>00617             xyzwrite = xyz.copy()
<a name="l00618"></a>00618             xyzwrite /= 10.0 <span class="comment"># GROMACS uses nanometers</span>
<a name="l00619"></a>00619             out.append(<span class="stringliteral">&quot;Generated by filecnv.py : &quot;</span> + self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5e092c726455a18c9300f5c5362121d8" title="The comments that usually go somewhere into the output file.">comms</a>[I])
<a name="l00620"></a>00620             out.append(<span class="stringliteral">&quot;%5i&quot;</span> % self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5d4d6bacac17decec84355c2b31d0834">na</a>())
<a name="l00621"></a>00621             <span class="keywordflow">for</span> an, line <span class="keywordflow">in</span> enumerate(xyzwrite):
<a name="l00622"></a>00622                 out.append(format_gro_coord(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#afcd4c8e1671af626d0267a243e69530d" title="Optional variable: the residue number.">resid</a>[an],self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4aebc6ada9bda74a6740568d4f3658eb" title="Optional variable: the residue name.">resname</a>[an],self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ab9ea84d9c71db7cdeea60970efd83f95" title="Optional variable: the atom name, which defaults to the elements.">atomname</a>[an],an+1,xyzwrite[an]))
<a name="l00623"></a>00623             out.append(format_gro_box(xyz = self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ac84c67d37f00c0f65e6fb6126e19f9bb" title="Optional variable: the box vectors (there would be self.ns of these)">boxes</a>[I]))
<a name="l00624"></a>00624         <span class="keywordflow">return</span> out
<a name="l00625"></a>00625 
<a name="l00626"></a>00626     <span class="keyword">def </span>require_resid(self):
<a name="l00627"></a>00627         <span class="keywordflow">if</span> self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#afcd4c8e1671af626d0267a243e69530d" title="Optional variable: the residue number.">resid</a> == <span class="keywordtype">None</span>:
<a name="l00628"></a>00628             na_res = int(raw_input(<span class="stringliteral">&quot;Enter how many atoms are in a residue -&gt; &quot;</span>))
<a name="l00629"></a>00629             self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#afcd4c8e1671af626d0267a243e69530d" title="Optional variable: the residue number.">resid</a> = [1 + i/na_res <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5d4d6bacac17decec84355c2b31d0834">na</a>())]
<a name="l00630"></a>00630             
<a name="l00631"></a>00631     <span class="keyword">def </span>require_resname(self):
<a name="l00632"></a>00632         <span class="keywordflow">if</span> self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4aebc6ada9bda74a6740568d4f3658eb" title="Optional variable: the residue name.">resname</a> == <span class="keywordtype">None</span>:
<a name="l00633"></a>00633             resname = raw_input(<span class="stringliteral">&quot;Enter a residue name (3-letter like &#39;SOL&#39;) -&gt; &quot;</span>)
<a name="l00634"></a>00634             self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a4aebc6ada9bda74a6740568d4f3658eb" title="Optional variable: the residue name.">resname</a> = [resname <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a5d4d6bacac17decec84355c2b31d0834">na</a>())]
<a name="l00635"></a>00635             
<a name="l00636"></a>00636     <span class="keyword">def </span>require_boxes(self):
<a name="l00637"></a>00637         <span class="keywordflow">if</span> self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ac84c67d37f00c0f65e6fb6126e19f9bb" title="Optional variable: the box vectors (there would be self.ns of these)">boxes</a> == <span class="keywordtype">None</span>:
<a name="l00638"></a>00638             boxstr = raw_input(<span class="stringliteral">&quot;Enter 1 / 3 / 9 numbers for a cubic / orthorhombic / triclinic box, use Angstrom -&gt; &quot;</span>)
<a name="l00639"></a>00639             box    = [float(i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> boxstr.split()]
<a name="l00640"></a>00640             <span class="keywordflow">if</span> len(box) == 3 <span class="keywordflow">or</span> len(box) == 9:
<a name="l00641"></a>00641                 self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ac84c67d37f00c0f65e6fb6126e19f9bb" title="Optional variable: the box vectors (there would be self.ns of these)">boxes</a> = [box <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a11a61266093c37ae61131b685a152863" title="The number of snapshots is determined by the length of self.xyzs.">ns</a>)]
<a name="l00642"></a>00642             <span class="keywordflow">elif</span> len(box) == 1:
<a name="l00643"></a>00643                 self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#ac84c67d37f00c0f65e6fb6126e19f9bb" title="Optional variable: the box vectors (there would be self.ns of these)">boxes</a> = [[box[0],box[0],box[0]] <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.<a class="code" href="classforcebalance_1_1molecule_1_1Molecule.html#a11a61266093c37ae61131b685a152863" title="The number of snapshots is determined by the length of self.xyzs.">ns</a>)]
<a name="l00644"></a>00644             <span class="keywordflow">else</span>:
<a name="l00645"></a>00645                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Not sure what to do since you gave me %i numbers&quot;</span> % len(box)
<a name="l00646"></a>00646                 exit(1)
<a name="l00647"></a>00647                 
<a name="l00648"></a>00648 
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Thu Feb 2 2012 13:21:19 for ForceBalance by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
