<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ForceBalance: forcebalance.forceenergymatch.ForceEnergyMatch Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="ForceBalanceLogo_sm.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ForceBalance
   &#160;<span id="projectnumber">0.11.0</span>
   </div>
   <div id="projectbrief">Automated optimization of force fields and empirical potentials</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/namespaces.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="todo.html"><span>To-Do&#160;List</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>forcebalance</b>      </li>
      <li class="navelem"><b>forceenergymatch</b>      </li>
      <li class="navelem"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html">ForceEnergyMatch</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a>  </div>
  <div class="headertitle">
<div class="title">forcebalance.forceenergymatch.ForceEnergyMatch Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="forcebalance::forceenergymatch::ForceEnergyMatch" --><!-- doxytag: inherits="fitsim::FittingSimulation" -->
<p>Subclass of FittingSimulation for force and energy matching.  
 <a href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for forcebalance.forceenergymatch.ForceEnergyMatch:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch__inherit__graph.svg" width="358" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for forcebalance.forceenergymatch.ForceEnergyMatch:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch__coll__graph.svg" width="358" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a7fb3eec3bcfaa43d639d2f11a5e87110">__init__</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Instantiation of the subclass.  <a href="#a7fb3eec3bcfaa43d639d2f11a5e87110"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#ae1b80656d41791a803815c7156db4584">read_reference_data</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the reference data (for force and energy matching) from a file such as qdata.txt.  <a href="#ae1b80656d41791a803815c7156db4584"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9ea80a1b19fa94e0df1029585c153c38"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::indicate" ref="a9ea80a1b19fa94e0df1029585c153c38" args="" -->
def&#160;</td><td class="memItemRight" valign="bottom"><b>indicate</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#acbc32c47a18fba3a6c31dd60b7185c8b">get</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">LPW 01-11-2012.  <a href="#acbc32c47a18fba3a6c31dd60b7185c8b"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afd8eefa624b9b64dfef20683741ae664"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::ns" ref="afd8eefa624b9b64dfef20683741ae664" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#afd8eefa624b9b64dfef20683741ae664">ns</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of snapshots. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9ce05c9cad112bcb3e31f2a6e8665c98"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::whamboltz" ref="a9ce05c9cad112bcb3e31f2a6e8665c98" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a9ce05c9cad112bcb3e31f2a6e8665c98">whamboltz</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to use WHAM Boltzmann weights. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5ace0ef78d472f70ff165c8e7186c4fe"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::sampcorr" ref="a5ace0ef78d472f70ff165c8e7186c4fe" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a5ace0ef78d472f70ff165c8e7186c4fe">sampcorr</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to use the Sampling Correction. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a32037a0b73cc5fd7c6499333f5912293"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::covariance" ref="a32037a0b73cc5fd7c6499333f5912293" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a32037a0b73cc5fd7c6499333f5912293">covariance</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to use the Covariance Matrix. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6071c00c12adaf8e9f06eea7a28ce27e"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::qmboltz" ref="a6071c00c12adaf8e9f06eea7a28ce27e" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a6071c00c12adaf8e9f06eea7a28ce27e">qmboltz</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to use QM Boltzmann weights. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3b6a9d0aa7e4b69eb23e4f505d66195f"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::qmboltztemp" ref="a3b6a9d0aa7e4b69eb23e4f505d66195f" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a3b6a9d0aa7e4b69eb23e4f505d66195f">qmboltztemp</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The temperature for QM Boltzmann weights. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad806cd30e5680e730071229e734fc1ed"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::fitatoms" ref="ad806cd30e5680e730071229e734fc1ed" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#ad806cd30e5680e730071229e734fc1ed">fitatoms</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of atoms that we are fitting. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a1d0bd5353342e99dc41ac0f209de5820">efweight</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The proportion of energy vs.  <a href="#a1d0bd5353342e99dc41ac0f209de5820"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afd7ae727b7476e0499aa7bc85117a386"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::whamboltz_wts" ref="afd7ae727b7476e0499aa7bc85117a386" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#afd7ae727b7476e0499aa7bc85117a386">whamboltz_wts</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">WHAM Boltzmann weights. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aac5b8e8cf92eee622f21a69680d243f7"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::qmboltz_wts" ref="aac5b8e8cf92eee622f21a69680d243f7" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#aac5b8e8cf92eee622f21a69680d243f7">qmboltz_wts</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">QM Boltzmann weights. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a389e2e8ac22139d33747586a57f690c9"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::eqm" ref="a389e2e8ac22139d33747586a57f690c9" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a389e2e8ac22139d33747586a57f690c9">eqm</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference (QM) energies. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16cada305b69fdc74aa67ba9683d29b3"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::emd0" ref="a16cada305b69fdc74aa67ba9683d29b3" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a16cada305b69fdc74aa67ba9683d29b3">emd0</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Energies of the sampling simulation. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a71baa0372a843774d48528b0858b4239"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::fqm" ref="a71baa0372a843774d48528b0858b4239" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a71baa0372a843774d48528b0858b4239">fqm</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference (QM) forces. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a04cfa0f08b99ab957dc38831d840c1ef"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::qfnm" ref="a04cfa0f08b99ab957dc38831d840c1ef" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a04cfa0f08b99ab957dc38831d840c1ef">qfnm</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The qdata.txt file that contains the QM energies and forces. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20e0ad4143390561a0062676bdf3e626"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::natoms" ref="a20e0ad4143390561a0062676bdf3e626" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a20e0ad4143390561a0062676bdf3e626">natoms</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of true atoms. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3bcd37304783e27dd232f8b27664e0cf"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::e_err" ref="a3bcd37304783e27dd232f8b27664e0cf" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a3bcd37304783e27dd232f8b27664e0cf">e_err</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Qualitative Indicator: average energy error (in kJ/mol) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa851cc51747bb97bf0f2d1eb0df572b2"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::f_err" ref="aa851cc51747bb97bf0f2d1eb0df572b2" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#aa851cc51747bb97bf0f2d1eb0df572b2">f_err</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Qualitative Indicator: average force error (fractional) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afa604a9151487b2e7eb3fe7b91ddb615"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::traj" ref="afa604a9151487b2e7eb3fe7b91ddb615" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#afa604a9151487b2e7eb3fe7b91ddb615">traj</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read in the trajectory file. <br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Subclass of FittingSimulation for force and energy matching. </p>
<p>In force and energy matching, we introduce the following concepts:</p>
<ul>
<li>The number of snapshots</li>
<li>The reference energies and forces (eqm, fqm) and the file they belong in (qdata.txt)</li>
<li>The sampling simulation energies (emd0)</li>
<li>The WHAM Boltzmann weights (these are computed externally and passed in)</li>
<li>The QM Boltzmann weights (computed internally using the difference between eqm and emd0)</li>
</ul>
<p>There are also these little details:</p>
<ul>
<li>Switches for whether to turn on certain Boltzmann weights (they stack)</li>
<li>Temperature for the QM Boltzmann weights</li>
<li>Whether to fit a subset of atoms</li>
</ul>
<p>This subclass contains the 'get' method for building the objective function from any simulation software (a driver to run the program and read output is still required). The 'get' method can be overridden by subclasses like ForceEnergyMatch_GMXX2. </p>

<p>Definition at line <a class="el" href="forceenergymatch_8py_source.html#l00037">37</a> of file <a class="el" href="forceenergymatch_8py_source.html">forceenergymatch.py</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7fb3eec3bcfaa43d639d2f11a5e87110"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::__init__" ref="a7fb3eec3bcfaa43d639d2f11a5e87110" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a7fb3eec3bcfaa43d639d2f11a5e87110">forcebalance.forceenergymatch.ForceEnergyMatch.__init__</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sim_opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>forcefield</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Instantiation of the subclass. </p>
<p>We begin by instantiating the superclass here and also defining a number of core concepts for energy / force matching.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>Obtain the number of true atoms (or the particle -&gt; atom mapping) from the force field. </dd></dl>

<p>Definition at line <a class="el" href="forceenergymatch_8py_source.html#l00050">50</a> of file <a class="el" href="forceenergymatch_8py_source.html">forceenergymatch.py</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="acbc32c47a18fba3a6c31dd60b7185c8b"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::get" ref="acbc32c47a18fba3a6c31dd60b7185c8b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#acbc32c47a18fba3a6c31dd60b7185c8b">forcebalance.forceenergymatch.ForceEnergyMatch.get</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mvals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>AGrad</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>AHess</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tempdir</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>LPW 01-11-2012. </p>
<p>This subroutine builds the objective function (and optionally its derivatives) from a general simulation software. This is in contrast to using GROMACS-X2, which computes the objective function and prints it out; then 'get' only needs to call GROMACS and read it in.</p>
<p>This subroutine interfaces with simulation software 'drivers'. The driver is only expected to give the energy and forces.</p>
<p>Now this subroutine may sound trivial since the objective function is simply a least-squares quantity (M-Q)^2 - but there are a number of nontrivial considerations. I will list them here.</p>
<p>0) Polytensor formulation: Because there may exist covariance between different components of the force (or covariance between the energy and the force), we build the objective function by taking outer products of vectors that have the form [E F_1x F_1y F_1z F_2x F_2y ... ], and then we trace it with the inverse of the covariance matrix to get the objective function.</p>
<p>1) Boltzmann weights and normalization: Each snapshot has its own Boltzmann weight, which may or may not be normalized. This subroutine does the normalization automatically.</p>
<p>2) Subtracting out the mean energy gap: The zero-point energy difference between reference and fitting simulations is meaningless. This subroutine subtracts it out.</p>
<p>3) Hybrid ensembles: This program builds a combined objective function from both MM and QM ensembles, which is rigorously better than using a single ensemble.</p>
<p>Note that this subroutine does not do EVERYTHING that GROMACS-X2 can do, which includes:</p>
<p>1) Internal coordinate systems 2) 'Sampling correction' (deprecated, since it doesn't seem to work) 3) Analytic derivatives</p>
<p>In the previous code (ForTune) this subroutine used analytic first derivatives of the energy and force to build the derivatives of the objective function. Here I will take a simplified approach, because building the derivatives are cumbersome. For now we will return the objective function ONLY. A two-point central difference should give us the first and diagonal second derivative anyhow.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>Parallelization over snapshots is not implemented yet</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mvals</td><td>Mathematical parameter values </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AGrad</td><td>Switch to turn on analytic gradient, useless here </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AHess</td><td>Switch to turn on analytic Hessian, useless here </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tempdir</td><td>Temporary directory for running computation </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Answer Contribution to the objective function </dd></dl>

<p>Definition at line <a class="el" href="forceenergymatch_8py_source.html#l00307">307</a> of file <a class="el" href="forceenergymatch_8py_source.html">forceenergymatch.py</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch_acbc32c47a18fba3a6c31dd60b7185c8b_cgraph.svg" width="891" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae1b80656d41791a803815c7156db4584"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::read_reference_data" ref="ae1b80656d41791a803815c7156db4584" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def <a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#ae1b80656d41791a803815c7156db4584">forcebalance.forceenergymatch.ForceEnergyMatch.read_reference_data</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read the reference data (for force and energy matching) from a file such as qdata.txt. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>Add an option for picking any slice out of qdata.txt, helpful for cross-validation</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo:</a></b></dt><dd>Closer integration of reference data with program - leave behind the qdata.txt format? (For now, I like the readability of qdata.txt)</dd></dl>
<p>After reading in the information from qdata.txt, it is converted into the GROMACS energy units (kind of an arbitrary choice); forces (kind of a misnomer in qdata.txt) are multipled by -1 to convert gradients to forces.</p>
<p>We also subtract out the mean energies of all energy arrays because energy/force matching does not account for zero-point energy differences between MM and QM (i.e. energy of electrons in core orbitals).</p>
<p>The configurations in force/energy matching typically come from a the thermodynamic ensemble of the MM force field at some temperature (by running MD, for example), and for many reasons it is helpful to introduce non-Boltzmann weights in front of these configurations. There are two options: WHAM Boltzmann weights (for combining the weights of several simulations together) and QM Boltzmann weights (for converting MM weights into QM weights). Note that the two sets of weights 'stack'; i.e. they can be used at the same time.</p>
<p>A 'hybrid' ensemble is possible where we use 50% MM and 50% QM weights. Please read more in LPW and Troy Van Voorhis, JCP Vol. 133, Pg. 231101 (2010), doi:10.1063/1.3519043.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>The WHAM Boltzmann weights are generated by external scripts (wanalyze.py and make-wham-data.sh) and passed in; perhaps these scripts can be added to the ForceBalance distribution or integrated more tightly.</dd></dl>
<p>Finally, note that using non-Boltzmann weights degrades the statistical information content of the snapshots. This problem will generally become worse if the ensemble to which we're reweighting is dramatically different from the one we're sampling from. We end up with a set of Boltzmann weights like [1e-9, 1e-9, 1.0, 1e-9, 1e-9 ... ] and this is essentially just one snapshot. I believe Troy is working on something to cure this problem.</p>
<p>Here, we have a measure for the information content of our snapshots, which comes easily from the definition of information entropy:</p>
<p>S = -1*Sum_i(P_i*log(P_i)) InfoContent = exp(-S)</p>
<p>With uniform weights, InfoContent is equal to the number of snapshots; with horrible weights, InfoContent is closer to one. </p>

<p>Definition at line <a class="el" href="forceenergymatch_8py_source.html#l00169">169</a> of file <a class="el" href="forceenergymatch_8py_source.html">forceenergymatch.py</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a1d0bd5353342e99dc41ac0f209de5820"></a><!-- doxytag: member="forcebalance::forceenergymatch::ForceEnergyMatch::efweight" ref="a1d0bd5353342e99dc41ac0f209de5820" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classforcebalance_1_1forceenergymatch_1_1ForceEnergyMatch.html#a1d0bd5353342e99dc41ac0f209de5820">forcebalance::forceenergymatch.ForceEnergyMatch::efweight</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The proportion of energy vs. </p>
<p>force. </p>

<p>Definition at line <a class="el" href="forceenergymatch_8py_source.html#l00058">58</a> of file <a class="el" href="forceenergymatch_8py_source.html">forceenergymatch.py</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>forcebalance/forcebalance/<a class="el" href="forceenergymatch_8py_source.html">forceenergymatch.py</a></li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Thu Feb 2 2012 13:21:20 for ForceBalance by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
